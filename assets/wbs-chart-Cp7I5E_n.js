import{A as e,C as t,E as n,N as r,O as i,b as a,d as o,f as s,g as c,h as l,j as u,k as d,l as f,o as p,p as m,s as h,u as g,w as _,x as v,y}from"./index-DsoFNqQt.js";import{t as b}from"./_plugin-vue_export-helper-9n1O4nl6.js";var x={__name:`WbsChart`,props:{hierarchicalData:{type:Object,required:!0},selectedNode:{type:Object,default:null},isDarkMode:{type:Boolean,default:!1},chartInstance:{type:Object,required:!0}},emits:[`node-click`],setup(e,{expose:r,emit:i}){let o=e,s=d(null);return v(()=>{a(()=>{s.value&&o.chartInstance&&o.chartInstance.initializeChart(s.value)})}),n(()=>o.hierarchicalData,()=>{o.chartInstance&&o.hierarchicalData&&o.chartInstance.updateChart()},{deep:!0,immediate:!0}),n(()=>o.selectedNode,()=>{o.chartInstance&&o.chartInstance.updateChart()}),n(()=>o.isDarkMode,()=>{o.chartInstance&&o.chartInstance.updateChart()}),r({exportPNG:()=>o.chartInstance?.exportPNG()}),(e,n)=>(t(),c(`div`,{ref_key:`chartContainer`,ref:s,class:`chart-container`},null,512))}},S=b(x,[[`__scopeId`,`data-v-0cf33393`]]),C={class:`toolbar-content`},w=[`disabled`],T=[`value`],E={class:`toolbar-actions`},ee=[`disabled`],D={__name:`EditToolbar`,props:{isVisible:{type:Boolean,default:!1},selectedNode:{type:Object,default:null},parentOptions:{type:Array,default:()=>[]},selectedParentId:{type:String,default:``},nodeName:{type:String,default:``}},emits:[`update:nodeName`,`update:selectedParentId`,`close`,`save`,`add-child`,`add-sibling`,`delete`],setup(e,{emit:d}){let f=e,g=d,v=s(()=>f.selectedNode?.depth===0),y=s(()=>f.selectedNode?.depth>=2),b=s({get:()=>f.nodeName,set:e=>g(`update:nodeName`,e)}),x=s({get:()=>f.selectedParentId,set:e=>g(`update:selectedParentId`,e)}),S=()=>{g(`close`)},D=()=>{g(`save`)},te=()=>{g(`add-child`)},ne=()=>{g(`add-sibling`)},re=()=>{g(`delete`)},O=e=>{(e.ctrlKey||e.metaKey)&&e.key===`Enter`&&(e.preventDefault(),D()),e.key===`Escape`&&S()};return n(()=>f.isVisible,e=>{e&&a(()=>{let e=document.getElementById(`node-name-input`);e&&e.focus()})}),(n,a)=>(t(),c(`div`,{class:u([`edit-toolbar`,{hidden:!e.isVisible,"-translate-x-full":!e.isVisible}])},[m(`div`,{class:`toolbar-header`},[a[2]||=m(`h2`,null,`노드 편집`,-1),m(`button`,{onClick:S,class:`close-btn`},`×`)]),m(`div`,C,[m(`div`,null,[a[3]||=m(`label`,{for:`node-name-input`},`노드 이름`,-1),i(m(`textarea`,{id:`node-name-input`,"onUpdate:modelValue":a[0]||=e=>b.value=e,rows:`3`,onKeydown:O},null,544),[[h,b.value]])]),m(`div`,null,[a[4]||=m(`label`,{for:`node-parent-select`},`부모 노드 변경`,-1),i(m(`select`,{id:`node-parent-select`,"onUpdate:modelValue":a[1]||=e=>x.value=e,disabled:v.value},[(t(!0),c(o,null,_(e.parentOptions,e=>(t(),c(`option`,{key:e.id,value:e.id},r(e.label),9,T))),128))],8,w),[[p,x.value]])])]),m(`div`,E,[m(`button`,{onClick:D,class:`btn-save`},`변경 사항 저장`),y.value?l(``,!0):(t(),c(`button`,{key:0,onClick:te,class:`btn-add-child`},` 자식 노드 추가 `)),v.value?l(``,!0):(t(),c(`button`,{key:1,onClick:ne,class:`btn-add-sibling`},` 형제 노드 추가 `)),m(`button`,{onClick:re,class:`btn-delete`,disabled:v.value},` 노드 삭제 `,8,ee)])],2))}},te=b(D,[[`__scopeId`,`data-v-8c8b4da9`]]),ne={class:`toolbar`},re=[`title`],O={key:0,class:`w-5 h-5 mr-2`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`},ie={key:1,class:`w-5 h-5 mr-2`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`},k={__name:`Toolbar`,props:{isDarkMode:{type:Boolean,required:!0}},emits:[`toggle-dark-mode`,`import-json`,`export-json`,`export-png`,`fit-to-view`],setup(e,{emit:n}){let i=n,a=()=>{i(`toggle-dark-mode`)},o=()=>{i(`import-json`)},s=()=>{i(`export-json`)},l=()=>{i(`export-png`)},u=()=>{i(`fit-to-view`)};return(n,i)=>(t(),c(`div`,ne,[m(`button`,{onClick:a,class:`toolbar-btn`,title:e.isDarkMode?`라이트 모드로 전환`:`다크 모드로 전환`},[e.isDarkMode?(t(),c(`svg`,O,[...i[0]||=[m(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z`},null,-1)]])):(t(),c(`svg`,ie,[...i[1]||=[m(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z`},null,-1)]])),m(`span`,null,r(e.isDarkMode?`라이트 모드`:`다크 모드`),1)],8,re),m(`button`,{onClick:o,class:`toolbar-btn`},[...i[2]||=[m(`svg`,{class:`w-5 h-5 mr-2`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`},[m(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12`})],-1),m(`span`,null,`불러오기`,-1)]]),m(`button`,{onClick:s,class:`toolbar-btn`},[...i[3]||=[m(`svg`,{class:`w-5 h-5 mr-2`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`},[m(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4`})],-1),m(`span`,null,`내보내기`,-1)]]),m(`button`,{onClick:l,class:`toolbar-btn`},[...i[4]||=[m(`svg`,{class:`w-5 h-5 mr-2`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`},[m(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z`})],-1),m(`span`,null,`PNG로 저장`,-1)]]),m(`button`,{onClick:u,class:`toolbar-btn`,title:`전체 보기`},[...i[5]||=[m(`svg`,{class:`w-5 h-5 mr-2`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`},[m(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4`})],-1),m(`span`,null,`전체 보기`,-1)]])]))}},ae=b(k,[[`__scopeId`,`data-v-47054a63`]]),oe={class:`modal`},se=[`value`],ce={__name:`WbsModal`,props:{showModal:{type:Boolean,required:!0},modalTitle:{type:String,default:``},modalMessage:{type:String,default:``},modalShowInput:{type:Boolean,default:!1},modalInputValue:{type:String,default:``}},emits:[`ok`,`cancel`,`update:modalInputValue`],setup(e,{emit:i}){let o=e,s=i,u=d(null),p=e=>{s(`update:modalInputValue`,e.target.value)},h=()=>{s(`ok`)},_=()=>{s(`cancel`)},v=()=>{_()};return n(()=>o.showModal,e=>{e&&o.modalShowInput&&a(()=>{u.value&&u.value.focus()})}),(n,i)=>e.showModal?(t(),c(`div`,{key:0,class:`modal-overlay`,onClick:g(v,[`self`])},[m(`div`,oe,[m(`h3`,null,r(e.modalTitle),1),m(`p`,null,r(e.modalMessage),1),e.modalShowInput?(t(),c(`input`,{key:0,ref_key:`modalInput`,ref:u,type:`text`,value:e.modalInputValue,onInput:p,onKeydown:[f(h,[`enter`]),f(_,[`escape`])]},null,40,se)):l(``,!0),m(`div`,{class:`modal-actions`},[m(`button`,{onClick:_,class:`btn-cancel`},`취소`),m(`button`,{onClick:h,class:`btn-ok`},`확인`)])])])):l(``,!0)}},A=b(ce,[[`__scopeId`,`data-v-27ddb775`]]),le={value:()=>{}};function j(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+``)||r in n||/[\s.]/.test(r))throw Error(`illegal type: `+r);n[r]=[]}return new M(n)}function M(e){this._=e}function ue(e,t){return e.trim().split(/^|\s+/).map(function(e){var n=``,r=e.indexOf(`.`);if(r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),e&&!t.hasOwnProperty(e))throw Error(`unknown type: `+e);return{type:e,name:n}})}M.prototype=j.prototype={constructor:M,on:function(e,t){var n=this._,r=ue(e+``,n),i,a=-1,o=r.length;if(arguments.length<2){for(;++a<o;)if((i=(e=r[a]).type)&&(i=de(n[i],e.name)))return i;return}if(t!=null&&typeof t!=`function`)throw Error(`invalid callback: `+t);for(;++a<o;)if(i=(e=r[a]).type)n[i]=fe(n[i],e.name,t);else if(t==null)for(i in n)n[i]=fe(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new M(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=Array(i),r=0,i,a;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw Error(`unknown type: `+e);for(a=this._[e],r=0,i=a.length;r<i;++r)a[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw Error(`unknown type: `+e);for(var r=this._[e],i=0,a=r.length;i<a;++i)r[i].value.apply(t,n)}};function de(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function fe(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=le,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var pe=j,me={svg:`http://www.w3.org/2000/svg`,xhtml:`http://www.w3.org/1999/xhtml`,xlink:`http://www.w3.org/1999/xlink`,xml:`http://www.w3.org/XML/1998/namespace`,xmlns:`http://www.w3.org/2000/xmlns/`};function N(e){var t=e+=``,n=t.indexOf(`:`);return n>=0&&(t=e.slice(0,n))!==`xmlns`&&(e=e.slice(n+1)),me.hasOwnProperty(t)?{space:me[t],local:e}:e}function he(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===`http://www.w3.org/1999/xhtml`&&t.documentElement.namespaceURI===`http://www.w3.org/1999/xhtml`?t.createElement(e):t.createElementNS(n,e)}}function ge(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function _e(e){var t=N(e);return(t.local?ge:he)(t)}function ve(){}function ye(e){return e==null?ve:function(){return this.querySelector(e)}}function be(e){typeof e!=`function`&&(e=ye(e));for(var t=this._groups,n=t.length,r=Array(n),i=0;i<n;++i)for(var a=t[i],o=a.length,s=r[i]=Array(o),c,l,u=0;u<o;++u)(c=a[u])&&(l=e.call(c,c.__data__,u,a))&&(`__data__`in c&&(l.__data__=c.__data__),s[u]=l);return new F(r,this._parents)}function xe(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Se(){return[]}function Ce(e){return e==null?Se:function(){return this.querySelectorAll(e)}}function we(e){return function(){return xe(e.apply(this,arguments))}}function Te(e){e=typeof e==`function`?we(e):Ce(e);for(var t=this._groups,n=t.length,r=[],i=[],a=0;a<n;++a)for(var o=t[a],s=o.length,c,l=0;l<s;++l)(c=o[l])&&(r.push(e.call(c,c.__data__,l,o)),i.push(c));return new F(r,i)}function Ee(e){return function(){return this.matches(e)}}function De(e){return function(t){return t.matches(e)}}var Oe=Array.prototype.find;function ke(e){return function(){return Oe.call(this.children,e)}}function Ae(){return this.firstElementChild}function je(e){return this.select(e==null?Ae:ke(typeof e==`function`?e:De(e)))}var Me=Array.prototype.filter;function Ne(){return Array.from(this.children)}function Pe(e){return function(){return Me.call(this.children,e)}}function Fe(e){return this.selectAll(e==null?Ne:Pe(typeof e==`function`?e:De(e)))}function Ie(e){typeof e!=`function`&&(e=Ee(e));for(var t=this._groups,n=t.length,r=Array(n),i=0;i<n;++i)for(var a=t[i],o=a.length,s=r[i]=[],c,l=0;l<o;++l)(c=a[l])&&e.call(c,c.__data__,l,a)&&s.push(c);return new F(r,this._parents)}function Le(e){return Array(e.length)}function Re(){return new F(this._enter||this._groups.map(Le),this._parents)}function ze(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}ze.prototype={constructor:ze,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Be(e){return function(){return e}}function Ve(e,t,n,r,i,a){for(var o=0,s,c=t.length,l=a.length;o<l;++o)(s=t[o])?(s.__data__=a[o],r[o]=s):n[o]=new ze(e,a[o]);for(;o<c;++o)(s=t[o])&&(i[o]=s)}function He(e,t,n,r,i,a,o){var s,c,l=new Map,u=t.length,d=a.length,f=Array(u),p;for(s=0;s<u;++s)(c=t[s])&&(f[s]=p=o.call(c,c.__data__,s,t)+``,l.has(p)?i[s]=c:l.set(p,c));for(s=0;s<d;++s)p=o.call(e,a[s],s,a)+``,(c=l.get(p))?(r[s]=c,c.__data__=a[s],l.delete(p)):n[s]=new ze(e,a[s]);for(s=0;s<u;++s)(c=t[s])&&l.get(f[s])===c&&(i[s]=c)}function Ue(e){return e.__data__}function We(e,t){if(!arguments.length)return Array.from(this,Ue);var n=t?He:Ve,r=this._parents,i=this._groups;typeof e!=`function`&&(e=Be(e));for(var a=i.length,o=Array(a),s=Array(a),c=Array(a),l=0;l<a;++l){var u=r[l],d=i[l],f=d.length,p=Ge(e.call(u,u&&u.__data__,l,r)),m=p.length,h=s[l]=Array(m),g=o[l]=Array(m),_=c[l]=Array(f);n(u,d,h,g,_,p,t);for(var v=0,y=0,b,x;v<m;++v)if(b=h[v]){for(v>=y&&(y=v+1);!(x=g[y])&&++y<m;);b._next=x||null}}return o=new F(o,r),o._enter=s,o._exit=c,o}function Ge(e){return typeof e==`object`&&`length`in e?e:Array.from(e)}function Ke(){return new F(this._exit||this._groups.map(Le),this._parents)}function qe(e,t,n){var r=this.enter(),i=this,a=this.exit();return typeof e==`function`?(r=e(r),r&&=r.selection()):r=r.append(e+``),t!=null&&(i=t(i),i&&=i.selection()),n==null?a.remove():n(a),r&&i?r.merge(i).order():i}function Je(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,a=r.length,o=Math.min(i,a),s=Array(i),c=0;c<o;++c)for(var l=n[c],u=r[c],d=l.length,f=s[c]=Array(d),p,m=0;m<d;++m)(p=l[m]||u[m])&&(f[m]=p);for(;c<i;++c)s[c]=n[c];return new F(s,this._parents)}function Ye(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,a=r[i],o;--i>=0;)(o=r[i])&&(a&&o.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(o,a),a=o);return this}function Xe(e){e||=Ze;function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}for(var n=this._groups,r=n.length,i=Array(r),a=0;a<r;++a){for(var o=n[a],s=o.length,c=i[a]=Array(s),l,u=0;u<s;++u)(l=o[u])&&(c[u]=l);c.sort(t)}return new F(i,this._parents).order()}function Ze(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Qe(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function $e(){return Array.from(this)}function et(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null}function tt(){let e=0;for(let t of this)++e;return e}function nt(){return!this.node()}function rt(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],a=0,o=i.length,s;a<o;++a)(s=i[a])&&e.call(s,s.__data__,a,i);return this}function it(e){return function(){this.removeAttribute(e)}}function at(e){return function(){this.removeAttributeNS(e.space,e.local)}}function ot(e,t){return function(){this.setAttribute(e,t)}}function st(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function ct(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function lt(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function ut(e,t){var n=N(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?at:it:typeof t==`function`?n.local?lt:ct:n.local?st:ot)(n,t))}function dt(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function ft(e){return function(){this.style.removeProperty(e)}}function pt(e,t,n){return function(){this.style.setProperty(e,t,n)}}function mt(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function ht(e,t,n){return arguments.length>1?this.each((t==null?ft:typeof t==`function`?mt:pt)(e,t,n??``)):P(this.node(),e)}function P(e,t){return e.style.getPropertyValue(t)||dt(e).getComputedStyle(e,null).getPropertyValue(t)}function gt(e){return function(){delete this[e]}}function _t(e,t){return function(){this[e]=t}}function vt(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function yt(e,t){return arguments.length>1?this.each((t==null?gt:typeof t==`function`?vt:_t)(e,t)):this.node()[e]}function bt(e){return e.trim().split(/^|\s+/)}function xt(e){return e.classList||new St(e)}function St(e){this._node=e,this._names=bt(e.getAttribute(`class`)||``)}St.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute(`class`,this._names.join(` `)))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute(`class`,this._names.join(` `)))},contains:function(e){return this._names.indexOf(e)>=0}};function Ct(e,t){for(var n=xt(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function wt(e,t){for(var n=xt(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function Tt(e){return function(){Ct(this,e)}}function Et(e){return function(){wt(this,e)}}function Dt(e,t){return function(){(t.apply(this,arguments)?Ct:wt)(this,e)}}function Ot(e,t){var n=bt(e+``);if(arguments.length<2){for(var r=xt(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t==`function`?Dt:t?Tt:Et)(n,t))}function kt(){this.textContent=``}function At(e){return function(){this.textContent=e}}function jt(e){return function(){this.textContent=e.apply(this,arguments)??``}}function Mt(e){return arguments.length?this.each(e==null?kt:(typeof e==`function`?jt:At)(e)):this.node().textContent}function Nt(){this.innerHTML=``}function Pt(e){return function(){this.innerHTML=e}}function Ft(e){return function(){this.innerHTML=e.apply(this,arguments)??``}}function It(e){return arguments.length?this.each(e==null?Nt:(typeof e==`function`?Ft:Pt)(e)):this.node().innerHTML}function Lt(){this.nextSibling&&this.parentNode.appendChild(this)}function Rt(){return this.each(Lt)}function zt(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Bt(){return this.each(zt)}function Vt(e){var t=typeof e==`function`?e:_e(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Ht(){return null}function Ut(e,t){var n=typeof e==`function`?e:_e(e),r=t==null?Ht:typeof t==`function`?t:ye(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Wt(){var e=this.parentNode;e&&e.removeChild(this)}function Gt(){return this.each(Wt)}function Kt(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function qt(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Jt(e){return this.select(e?qt:Kt)}function Yt(e){return arguments.length?this.property(`__data__`,e):this.node().__data__}function Xt(e){return function(t){e.call(this,t,this.__data__)}}function Zt(e){return e.trim().split(/^|\s+/).map(function(e){var t=``,n=e.indexOf(`.`);return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}})}function Qt(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,a;n<i;++n)a=t[n],(!e.type||a.type===e.type)&&a.name===e.name?this.removeEventListener(a.type,a.listener,a.options):t[++r]=a;++r?t.length=r:delete this.__on}}}function $t(e,t,n){return function(){var r=this.__on,i,a=Xt(t);if(r){for(var o=0,s=r.length;o<s;++o)if((i=r[o]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=a,i.options=n),i.value=t;return}}this.addEventListener(e.type,a,n),i={type:e.type,name:e.name,value:t,listener:a,options:n},r?r.push(i):this.__on=[i]}}function en(e,t,n){var r=Zt(e+``),i,a=r.length,o;if(arguments.length<2){var s=this.node().__on;if(s){for(var c=0,l=s.length,u;c<l;++c)for(i=0,u=s[c];i<a;++i)if((o=r[i]).type===u.type&&o.name===u.name)return u.value}return}for(s=t?$t:Qt,i=0;i<a;++i)this.each(s(r[i],t,n));return this}function tn(e,t,n){var r=dt(e),i=r.CustomEvent;typeof i==`function`?i=new i(t,n):(i=r.document.createEvent(`Event`),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function nn(e,t){return function(){return tn(this,e,t)}}function rn(e,t){return function(){return tn(this,e,t.apply(this,arguments))}}function an(e,t){return this.each((typeof t==`function`?rn:nn)(e,t))}function*on(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,a=r.length,o;i<a;++i)(o=r[i])&&(yield o)}var sn=[null];function F(e,t){this._groups=e,this._parents=t}function cn(){return new F([[document.documentElement]],sn)}function ln(){return this}F.prototype=cn.prototype={constructor:F,select:be,selectAll:Te,selectChild:je,selectChildren:Fe,filter:Ie,data:We,enter:Re,exit:Ke,join:qe,merge:Je,selection:ln,order:Ye,sort:Xe,call:Qe,nodes:$e,node:et,size:tt,empty:nt,each:rt,attr:ut,style:ht,property:yt,classed:Ot,text:Mt,html:It,raise:Rt,lower:Bt,append:Vt,insert:Ut,remove:Gt,clone:Jt,datum:Yt,on:en,dispatch:an,[Symbol.iterator]:on};var un=cn;function I(e){return typeof e==`string`?new F([[document.querySelector(e)]],[document.documentElement]):new F([[e]],sn)}function dn(e){let t;for(;t=e.sourceEvent;)e=t;return e}function L(e,t){if(e=dn(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}const fn={capture:!0,passive:!1};function pn(e){e.preventDefault(),e.stopImmediatePropagation()}function mn(e){var t=e.document.documentElement,n=I(e).on(`dragstart.drag`,pn,fn);`onselectstart`in t?n.on(`selectstart.drag`,pn,fn):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect=`none`)}function hn(e,t){var n=e.document.documentElement,r=I(e).on(`dragstart.drag`,null);t&&(r.on(`click.drag`,pn,fn),setTimeout(function(){r.on(`click.drag`,null)},0)),`onselectstart`in n?r.on(`selectstart.drag`,null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function gn(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function _n(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function vn(){}var yn=.7,bn=1/yn,R=`\\s*([+-]?\\d+)\\s*`,xn=`\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*`,z=`\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*`,Sn=/^#([0-9a-f]{3,8})$/,Cn=RegExp(`^rgb\\(${R},${R},${R}\\)$`),wn=RegExp(`^rgb\\(${z},${z},${z}\\)$`),Tn=RegExp(`^rgba\\(${R},${R},${R},${xn}\\)$`),En=RegExp(`^rgba\\(${z},${z},${z},${xn}\\)$`),Dn=RegExp(`^hsl\\(${xn},${z},${z}\\)$`),On=RegExp(`^hsla\\(${xn},${z},${z},${xn}\\)$`),kn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};gn(vn,Pn,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:An,formatHex:An,formatHex8:jn,formatHsl:Mn,formatRgb:Nn,toString:Nn});function An(){return this.rgb().formatHex()}function jn(){return this.rgb().formatHex8()}function Mn(){return Wn(this).formatHsl()}function Nn(){return this.rgb().formatRgb()}function Pn(e){var t,n;return e=(e+``).trim().toLowerCase(),(t=Sn.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Fn(t):n===3?new B(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?In(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?In(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Cn.exec(e))?new B(t[1],t[2],t[3],1):(t=wn.exec(e))?new B(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Tn.exec(e))?In(t[1],t[2],t[3],t[4]):(t=En.exec(e))?In(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Dn.exec(e))?Un(t[1],t[2]/100,t[3]/100,1):(t=On.exec(e))?Un(t[1],t[2]/100,t[3]/100,t[4]):kn.hasOwnProperty(e)?Fn(kn[e]):e===`transparent`?new B(NaN,NaN,NaN,0):null}function Fn(e){return new B(e>>16&255,e>>8&255,e&255,1)}function In(e,t,n,r){return r<=0&&(e=t=n=NaN),new B(e,t,n,r)}function Ln(e){return e instanceof vn||(e=Pn(e)),e?(e=e.rgb(),new B(e.r,e.g,e.b,e.opacity)):new B}function Rn(e,t,n,r){return arguments.length===1?Ln(e):new B(e,t,n,r??1)}function B(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}gn(B,Rn,_n(vn,{brighter(e){return e=e==null?bn:bn**+e,new B(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?yn:yn**+e,new B(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new B(V(this.r),V(this.g),V(this.b),Hn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:zn,formatHex:zn,formatHex8:Bn,formatRgb:Vn,toString:Vn}));function zn(){return`#${H(this.r)}${H(this.g)}${H(this.b)}`}function Bn(){return`#${H(this.r)}${H(this.g)}${H(this.b)}${H((isNaN(this.opacity)?1:this.opacity)*255)}`}function Vn(){let e=Hn(this.opacity);return`${e===1?`rgb(`:`rgba(`}${V(this.r)}, ${V(this.g)}, ${V(this.b)}${e===1?`)`:`, ${e})`}`}function Hn(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function V(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function H(e){return e=V(e),(e<16?`0`:``)+e.toString(16)}function Un(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new U(e,t,n,r)}function Wn(e){if(e instanceof U)return new U(e.h,e.s,e.l,e.opacity);if(e instanceof vn||(e=Pn(e)),!e)return new U;if(e instanceof U)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),o=NaN,s=a-i,c=(a+i)/2;return s?(o=t===a?(n-r)/s+(n<r)*6:n===a?(r-t)/s+2:(t-n)/s+4,s/=c<.5?a+i:2-a-i,o*=60):s=c>0&&c<1?0:o,new U(o,s,c,e.opacity)}function Gn(e,t,n,r){return arguments.length===1?Wn(e):new U(e,t,n,r??1)}function U(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}gn(U,Gn,_n(vn,{brighter(e){return e=e==null?bn:bn**+e,new U(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?yn:yn**+e,new U(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new B(Jn(e>=240?e-240:e+120,i,r),Jn(e,i,r),Jn(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new U(Kn(this.h),qn(this.s),qn(this.l),Hn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let e=Hn(this.opacity);return`${e===1?`hsl(`:`hsla(`}${Kn(this.h)}, ${qn(this.s)*100}%, ${qn(this.l)*100}%${e===1?`)`:`, ${e})`}`}}));function Kn(e){return e=(e||0)%360,e<0?e+360:e}function qn(e){return Math.max(0,Math.min(1,e||0))}function Jn(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}var Yn=e=>()=>e;function Xn(e,t){return function(n){return e+n*t}}function Zn(e,t,n){return e**=+n,t=t**+n-e,n=1/n,function(r){return(e+r*t)**+n}}function Qn(e){return(e=+e)==1?$n:function(t,n){return n-t?Zn(t,n,e):Yn(isNaN(t)?n:t)}}function $n(e,t){var n=t-e;return n?Xn(e,n):Yn(isNaN(e)?t:e)}var er=(function e(t){var n=Qn(t);function r(e,t){var r=n((e=Rn(e)).r,(t=Rn(t)).r),i=n(e.g,t.g),a=n(e.b,t.b),o=$n(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=a(t),e.opacity=o(t),e+``}}return r.gamma=e,r})(1);function W(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var tr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,nr=new RegExp(tr.source,`g`);function rr(e){return function(){return e}}function ir(e){return function(t){return e(t)+``}}function ar(e,t){var n=tr.lastIndex=nr.lastIndex=0,r,i,a,o=-1,s=[],c=[];for(e+=``,t+=``;(r=tr.exec(e))&&(i=nr.exec(t));)(a=i.index)>n&&(a=t.slice(n,a),s[o]?s[o]+=a:s[++o]=a),(r=r[0])===(i=i[0])?s[o]?s[o]+=i:s[++o]=i:(s[++o]=null,c.push({i:o,x:W(r,i)})),n=nr.lastIndex;return n<t.length&&(a=t.slice(n),s[o]?s[o]+=a:s[++o]=a),s.length<2?c[0]?ir(c[0].x):rr(t):(t=c.length,function(e){for(var n=0,r;n<t;++n)s[(r=c[n]).i]=r.x(e);return s.join(``)})}var or=180/Math.PI,sr={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function cr(e,t,n,r,i,a){var o,s,c;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,c/=s),e*r<t*n&&(e=-e,t=-t,c=-c,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(t,e)*or,skewX:Math.atan(c)*or,scaleX:o,scaleY:s}}var lr;function ur(e){let t=new(typeof DOMMatrix==`function`?DOMMatrix:WebKitCSSMatrix)(e+``);return t.isIdentity?sr:cr(t.a,t.b,t.c,t.d,t.e,t.f)}function dr(e){return e==null||(lr||=document.createElementNS(`http://www.w3.org/2000/svg`,`g`),lr.setAttribute(`transform`,e),!(e=lr.transform.baseVal.consolidate()))?sr:(e=e.matrix,cr(e.a,e.b,e.c,e.d,e.e,e.f))}function fr(e,t,n,r){function i(e){return e.length?e.pop()+` `:``}function a(e,r,i,a,o,s){if(e!==i||r!==a){var c=o.push(`translate(`,null,t,null,n);s.push({i:c-4,x:W(e,i)},{i:c-2,x:W(r,a)})}else (i||a)&&o.push(`translate(`+i+t+a+n)}function o(e,t,n,a){e===t?t&&n.push(i(n)+`rotate(`+t+r):(e-t>180?t+=360:t-e>180&&(e+=360),a.push({i:n.push(i(n)+`rotate(`,null,r)-2,x:W(e,t)}))}function s(e,t,n,a){e===t?t&&n.push(i(n)+`skewX(`+t+r):a.push({i:n.push(i(n)+`skewX(`,null,r)-2,x:W(e,t)})}function c(e,t,n,r,a,o){if(e!==n||t!==r){var s=a.push(i(a)+`scale(`,null,`,`,null,`)`);o.push({i:s-4,x:W(e,n)},{i:s-2,x:W(t,r)})}else (n!==1||r!==1)&&a.push(i(a)+`scale(`+n+`,`+r+`)`)}return function(t,n){var r=[],i=[];return t=e(t),n=e(n),a(t.translateX,t.translateY,n.translateX,n.translateY,r,i),o(t.rotate,n.rotate,r,i),s(t.skewX,n.skewX,r,i),c(t.scaleX,t.scaleY,n.scaleX,n.scaleY,r,i),t=n=null,function(e){for(var t=-1,n=i.length,a;++t<n;)r[(a=i[t]).i]=a.x(e);return r.join(``)}}}var pr=fr(ur,`px, `,`px)`,`deg)`),mr=fr(dr,`, `,`)`,`)`),hr=1e-12;function gr(e){return((e=Math.exp(e))+1/e)/2}function _r(e){return((e=Math.exp(e))-1/e)/2}function vr(e){return((e=Math.exp(2*e))-1)/(e+1)}var yr=(function e(t,n,r){function i(e,i){var a=e[0],o=e[1],s=e[2],c=i[0],l=i[1],u=i[2],d=c-a,f=l-o,p=d*d+f*f,m,h;if(p<hr)h=Math.log(u/s)/t,m=function(e){return[a+e*d,o+e*f,s*Math.exp(t*e*h)]};else{var g=Math.sqrt(p),_=(u*u-s*s+r*p)/(2*s*n*g),v=(u*u-s*s-r*p)/(2*u*n*g),y=Math.log(Math.sqrt(_*_+1)-_);h=(Math.log(Math.sqrt(v*v+1)-v)-y)/t,m=function(e){var r=e*h,i=gr(y),c=s/(n*g)*(i*vr(t*r+y)-_r(y));return[a+c*d,o+c*f,s*i/gr(t*r+y)]}}return m.duration=h*1e3*t/Math.SQRT2,m}return i.rho=function(t){var n=Math.max(.001,+t),r=n*n,i=r*r;return e(n,r,i)},i})(Math.SQRT2,2,4),G=0,br=0,xr=0,Sr=1e3,Cr,wr,Tr=0,K=0,Er=0,Dr=typeof performance==`object`&&performance.now?performance:Date,Or=typeof window==`object`&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function kr(){return K||=(Or(Ar),Dr.now()+Er)}function Ar(){K=0}function jr(){this._call=this._time=this._next=null}jr.prototype=Mr.prototype={constructor:jr,restart:function(e,t,n){if(typeof e!=`function`)throw TypeError(`callback is not a function`);n=(n==null?kr():+n)+(t==null?0:+t),!this._next&&wr!==this&&(wr?wr._next=this:Cr=this,wr=this),this._call=e,this._time=n,Lr()},stop:function(){this._call&&(this._call=null,this._time=1/0,Lr())}};function Mr(e,t,n){var r=new jr;return r.restart(e,t,n),r}function Nr(){kr(),++G;for(var e=Cr,t;e;)(t=K-e._time)>=0&&e._call.call(void 0,t),e=e._next;--G}function Pr(){K=(Tr=Dr.now())+Er,G=br=0;try{Nr()}finally{G=0,Ir(),K=0}}function Fr(){var e=Dr.now(),t=e-Tr;t>Sr&&(Er-=t,Tr=e)}function Ir(){for(var e,t=Cr,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Cr=n);wr=e,Lr(r)}function Lr(e){G||(br&&=clearTimeout(br),e-K>24?(e<1/0&&(br=setTimeout(Pr,e-Dr.now()-Er)),xr&&=clearInterval(xr)):(xr||=(Tr=Dr.now(),setInterval(Fr,Sr)),G=1,Or(Pr)))}function Rr(e,t,n){var r=new jr;return t=t==null?0:+t,r.restart(n=>{r.stop(),e(n+t)},t,n),r}var zr=pe(`start`,`end`,`cancel`,`interrupt`),Br=[];function Vr(e,t,n,r,i,a){var o=e.__transition;if(!o)e.__transition={};else if(n in o)return;Ur(e,n,{name:t,index:r,group:i,on:zr,tween:Br,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:0})}function Hr(e,t){var n=J(e,t);if(n.state>0)throw Error(`too late; already scheduled`);return n}function q(e,t){var n=J(e,t);if(n.state>3)throw Error(`too late; already running`);return n}function J(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw Error(`transition not found`);return n}function Ur(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=Mr(a,0,n.time);function a(e){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=e&&o(e-n.delay)}function o(a){var l,u,d,f;if(n.state!==1)return c();for(l in r)if(f=r[l],f.name===n.name){if(f.state===3)return Rr(o);f.state===4?(f.state=6,f.timer.stop(),f.on.call(`interrupt`,e,e.__data__,f.index,f.group),delete r[l]):+l<t&&(f.state=6,f.timer.stop(),f.on.call(`cancel`,e,e.__data__,f.index,f.group),delete r[l])}if(Rr(function(){n.state===3&&(n.state=4,n.timer.restart(s,n.delay,n.time),s(a))}),n.state=2,n.on.call(`start`,e,e.__data__,n.index,n.group),n.state===2){for(n.state=3,i=Array(d=n.tween.length),l=0,u=-1;l<d;++l)(f=n.tween[l].value.call(e,e.__data__,n.index,n.group))&&(i[++u]=f);i.length=u+1}}function s(t){for(var r=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(c),n.state=5,1),a=-1,o=i.length;++a<o;)i[a].call(e,r);n.state===5&&(n.on.call(`end`,e,e.__data__,n.index,n.group),c())}function c(){for(var i in n.state=6,n.timer.stop(),delete r[t],r)return;delete e.__transition}}function Wr(e,t){var n=e.__transition,r,i,a=!0,o;if(n){for(o in t=t==null?null:t+``,n){if((r=n[o]).name!==t){a=!1;continue}i=r.state>2&&r.state<5,r.state=6,r.timer.stop(),r.on.call(i?`interrupt`:`cancel`,e,e.__data__,r.index,r.group),delete n[o]}a&&delete e.__transition}}function Gr(e){return this.each(function(){Wr(this,e)})}function Kr(e,t){var n,r;return function(){var i=q(this,e),a=i.tween;if(a!==n){r=n=a;for(var o=0,s=r.length;o<s;++o)if(r[o].name===t){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function qr(e,t,n){var r,i;if(typeof n!=`function`)throw Error();return function(){var a=q(this,e),o=a.tween;if(o!==r){i=(r=o).slice();for(var s={name:t,value:n},c=0,l=i.length;c<l;++c)if(i[c].name===t){i[c]=s;break}c===l&&i.push(s)}a.tween=i}}function Jr(e,t){var n=this._id;if(e+=``,arguments.length<2){for(var r=J(this.node(),n).tween,i=0,a=r.length,o;i<a;++i)if((o=r[i]).name===e)return o.value;return null}return this.each((t==null?Kr:qr)(n,e,t))}function Yr(e,t,n){var r=e._id;return e.each(function(){var e=q(this,r);(e.value||={})[t]=n.apply(this,arguments)}),function(e){return J(e,r).value[t]}}function Xr(e,t){var n;return(typeof t==`number`?W:t instanceof Pn?er:(n=Pn(t))?(t=n,er):ar)(e,t)}function Zr(e){return function(){this.removeAttribute(e)}}function Qr(e){return function(){this.removeAttributeNS(e.space,e.local)}}function $r(e,t,n){var r,i=n+``,a;return function(){var o=this.getAttribute(e);return o===i?null:o===r?a:a=t(r=o,n)}}function ei(e,t,n){var r,i=n+``,a;return function(){var o=this.getAttributeNS(e.space,e.local);return o===i?null:o===r?a:a=t(r=o,n)}}function ti(e,t,n){var r,i,a;return function(){var o,s=n(this),c;return s==null?void this.removeAttribute(e):(o=this.getAttribute(e),c=s+``,o===c?null:o===r&&c===i?a:(i=c,a=t(r=o,s)))}}function ni(e,t,n){var r,i,a;return function(){var o,s=n(this),c;return s==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),c=s+``,o===c?null:o===r&&c===i?a:(i=c,a=t(r=o,s)))}}function ri(e,t){var n=N(e),r=n===`transform`?mr:Xr;return this.attrTween(e,typeof t==`function`?(n.local?ni:ti)(n,r,Yr(this,`attr.`+e,t)):t==null?(n.local?Qr:Zr)(n):(n.local?ei:$r)(n,r,t))}function ii(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function ai(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function oi(e,t){var n,r;function i(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&ai(e,i)),n}return i._value=t,i}function si(e,t){var n,r;function i(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&ii(e,i)),n}return i._value=t,i}function ci(e,t){var n=`attr.`+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!=`function`)throw Error();var r=N(e);return this.tween(n,(r.local?oi:si)(r,t))}function li(e,t){return function(){Hr(this,e).delay=+t.apply(this,arguments)}}function ui(e,t){return t=+t,function(){Hr(this,e).delay=t}}function di(e){var t=this._id;return arguments.length?this.each((typeof e==`function`?li:ui)(t,e)):J(this.node(),t).delay}function fi(e,t){return function(){q(this,e).duration=+t.apply(this,arguments)}}function pi(e,t){return t=+t,function(){q(this,e).duration=t}}function mi(e){var t=this._id;return arguments.length?this.each((typeof e==`function`?fi:pi)(t,e)):J(this.node(),t).duration}function hi(e,t){if(typeof t!=`function`)throw Error();return function(){q(this,e).ease=t}}function gi(e){var t=this._id;return arguments.length?this.each(hi(t,e)):J(this.node(),t).ease}function _i(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!=`function`)throw Error();q(this,e).ease=n}}function vi(e){if(typeof e!=`function`)throw Error();return this.each(_i(this._id,e))}function yi(e){typeof e!=`function`&&(e=Ee(e));for(var t=this._groups,n=t.length,r=Array(n),i=0;i<n;++i)for(var a=t[i],o=a.length,s=r[i]=[],c,l=0;l<o;++l)(c=a[l])&&e.call(c,c.__data__,l,a)&&s.push(c);return new Y(r,this._parents,this._name,this._id)}function bi(e){if(e._id!==this._id)throw Error();for(var t=this._groups,n=e._groups,r=t.length,i=n.length,a=Math.min(r,i),o=Array(r),s=0;s<a;++s)for(var c=t[s],l=n[s],u=c.length,d=o[s]=Array(u),f,p=0;p<u;++p)(f=c[p]||l[p])&&(d[p]=f);for(;s<r;++s)o[s]=t[s];return new Y(o,this._parents,this._name,this._id)}function xi(e){return(e+``).trim().split(/^|\s+/).every(function(e){var t=e.indexOf(`.`);return t>=0&&(e=e.slice(0,t)),!e||e===`start`})}function Si(e,t,n){var r,i,a=xi(t)?Hr:q;return function(){var o=a(this,e),s=o.on;s!==r&&(i=(r=s).copy()).on(t,n),o.on=i}}function Ci(e,t){var n=this._id;return arguments.length<2?J(this.node(),n).on.on(e):this.each(Si(n,e,t))}function wi(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function Ti(){return this.on(`end.remove`,wi(this._id))}function Ei(e){var t=this._name,n=this._id;typeof e!=`function`&&(e=ye(e));for(var r=this._groups,i=r.length,a=Array(i),o=0;o<i;++o)for(var s=r[o],c=s.length,l=a[o]=Array(c),u,d,f=0;f<c;++f)(u=s[f])&&(d=e.call(u,u.__data__,f,s))&&(`__data__`in u&&(d.__data__=u.__data__),l[f]=d,Vr(l[f],t,n,f,l,J(u,n)));return new Y(a,this._parents,t,n)}function Di(e){var t=this._name,n=this._id;typeof e!=`function`&&(e=Ce(e));for(var r=this._groups,i=r.length,a=[],o=[],s=0;s<i;++s)for(var c=r[s],l=c.length,u,d=0;d<l;++d)if(u=c[d]){for(var f=e.call(u,u.__data__,d,c),p,m=J(u,n),h=0,g=f.length;h<g;++h)(p=f[h])&&Vr(p,t,n,h,f,m);a.push(f),o.push(u)}return new Y(a,o,t,n)}var Oi=un.prototype.constructor;function ki(){return new Oi(this._groups,this._parents)}function Ai(e,t){var n,r,i;return function(){var a=P(this,e),o=(this.style.removeProperty(e),P(this,e));return a===o?null:a===n&&o===r?i:i=t(n=a,r=o)}}function ji(e){return function(){this.style.removeProperty(e)}}function Mi(e,t,n){var r,i=n+``,a;return function(){var o=P(this,e);return o===i?null:o===r?a:a=t(r=o,n)}}function Ni(e,t,n){var r,i,a;return function(){var o=P(this,e),s=n(this),c=s+``;return s??(c=s=(this.style.removeProperty(e),P(this,e))),o===c?null:o===r&&c===i?a:(i=c,a=t(r=o,s))}}function Pi(e,t){var n,r,i,a=`style.`+t,o=`end.`+a,s;return function(){var c=q(this,e),l=c.on,u=c.value[a]==null?s||=ji(t):void 0;(l!==n||i!==u)&&(r=(n=l).copy()).on(o,i=u),c.on=r}}function Fi(e,t,n){var r=(e+=``)==`transform`?pr:Xr;return t==null?this.styleTween(e,Ai(e,r)).on(`end.style.`+e,ji(e)):typeof t==`function`?this.styleTween(e,Ni(e,r,Yr(this,`style.`+e,t))).each(Pi(this._id,e)):this.styleTween(e,Mi(e,r,t),n).on(`end.style.`+e,null)}function Ii(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function Li(e,t,n){var r,i;function a(){var a=t.apply(this,arguments);return a!==i&&(r=(i=a)&&Ii(e,a,n)),r}return a._value=t,a}function Ri(e,t,n){var r=`style.`+(e+=``);if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!=`function`)throw Error();return this.tween(r,Li(e,t,n??``))}function zi(e){return function(){this.textContent=e}}function Bi(e){return function(){this.textContent=e(this)??``}}function Vi(e){return this.tween(`text`,typeof e==`function`?Bi(Yr(this,`text`,e)):zi(e==null?``:e+``))}function Hi(e){return function(t){this.textContent=e.call(this,t)}}function Ui(e){var t,n;function r(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&Hi(r)),t}return r._value=e,r}function Wi(e){var t=`text`;if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!=`function`)throw Error();return this.tween(t,Ui(e))}function Gi(){for(var e=this._name,t=this._id,n=Yi(),r=this._groups,i=r.length,a=0;a<i;++a)for(var o=r[a],s=o.length,c,l=0;l<s;++l)if(c=o[l]){var u=J(c,t);Vr(c,e,n,l,o,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Y(r,this._parents,e,n)}function Ki(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(a,o){var s={value:o},c={value:function(){--i===0&&a()}};n.each(function(){var n=q(this,r),i=n.on;i!==e&&(t=(e=i).copy(),t._.cancel.push(s),t._.interrupt.push(s),t._.end.push(c)),n.on=t}),i===0&&a()})}var qi=0;function Y(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function Ji(e){return un().transition(e)}function Yi(){return++qi}var X=un.prototype;Y.prototype=Ji.prototype={constructor:Y,select:Ei,selectAll:Di,selectChild:X.selectChild,selectChildren:X.selectChildren,filter:yi,merge:bi,selection:ki,transition:Gi,call:X.call,nodes:X.nodes,node:X.node,size:X.size,empty:X.empty,each:X.each,on:Ci,attr:ri,attrTween:ci,style:Fi,styleTween:Ri,text:Vi,textTween:Wi,remove:Ti,tween:Jr,delay:di,duration:mi,ease:gi,easeVarying:vi,end:Ki,[Symbol.iterator]:X[Symbol.iterator]};function Xi(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Zi={time:null,delay:0,duration:250,ease:Xi};function Qi(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw Error(`transition ${t} not found`);return n}function $i(e){var t,n;e instanceof Y?(t=e._id,e=e._name):(t=Yi(),(n=Zi).time=kr(),e=e==null?null:e+``);for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var o=r[a],s=o.length,c,l=0;l<s;++l)(c=o[l])&&Vr(c,e,t,l,o,n||Qi(c,t));return new Y(r,this._parents,e,t)}un.prototype.interrupt=Gr,un.prototype.transition=$i;var{abs:ea,max:ta,min:na}=Math;[`w`,`e`].map(ra),[`n`,`s`].map(ra),[`n`,`w`,`e`,`s`,`nw`,`ne`,`sw`,`se`].map(ra);function ra(e){return{type:e}}function ia(e){var t=0,n=e.children,r=n&&n.length;if(!r)t=1;else for(;--r>=0;)t+=n[r].value;e.value=t}function aa(){return this.eachAfter(ia)}function oa(e,t){let n=-1;for(let r of this)e.call(t,r,++n,this);return this}function sa(e,t){for(var n=this,r=[n],i,a,o=-1;n=r.pop();)if(e.call(t,n,++o,this),i=n.children)for(a=i.length-1;a>=0;--a)r.push(i[a]);return this}function ca(e,t){for(var n=this,r=[n],i=[],a,o,s,c=-1;n=r.pop();)if(i.push(n),a=n.children)for(o=0,s=a.length;o<s;++o)r.push(a[o]);for(;n=i.pop();)e.call(t,n,++c,this);return this}function la(e,t){let n=-1;for(let r of this)if(e.call(t,r,++n,this))return r}function ua(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,r=t.children,i=r&&r.length;--i>=0;)n+=r[i].value;t.value=n})}function da(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function fa(e){for(var t=this,n=pa(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var i=r.length;e!==n;)r.splice(i,0,e),e=e.parent;return r}function pa(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;for(e=n.pop(),t=r.pop();e===t;)i=e,e=n.pop(),t=r.pop();return i}function ma(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function ha(){return Array.from(this)}function ga(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function _a(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*va(){var e=this,t,n=[e],r,i,a;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,r=e.children)for(i=0,a=r.length;i<a;++i)n.push(r[i]);while(n.length)}function ya(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=Sa)):t===void 0&&(t=xa);for(var n=new Ta(e),r,i=[n],a,o,s,c;r=i.pop();)if((o=t(r.data))&&(c=(o=Array.from(o)).length))for(r.children=o,s=c-1;s>=0;--s)i.push(a=o[s]=new Ta(o[s])),a.parent=r,a.depth=r.depth+1;return n.eachBefore(wa)}function ba(){return ya(this).eachBefore(Ca)}function xa(e){return e.children}function Sa(e){return Array.isArray(e)?e[1]:null}function Ca(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function wa(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function Ta(e){this.data=e,this.depth=this.height=0,this.parent=null}Ta.prototype=ya.prototype={constructor:Ta,count:aa,each:oa,eachAfter:ca,eachBefore:sa,find:la,sum:ua,sort:da,path:fa,ancestors:ma,descendants:ha,leaves:ga,links:_a,copy:ba,[Symbol.iterator]:va};var Ea=e=>()=>e;function Da(e,{sourceEvent:t,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function Z(e,t,n){this.k=e,this.x=t,this.y=n}Z.prototype={constructor:Z,scale:function(e){return e===1?this:new Z(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Z(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return`translate(`+this.x+`,`+this.y+`) scale(`+this.k+`)`}};var Q=new Z(1,0,0);Oa.prototype=Z.prototype;function Oa(e){for(;!e.__zoom;)if(!(e=e.parentNode))return Q;return e.__zoom}function ka(e){e.stopImmediatePropagation()}function Aa(e){e.preventDefault(),e.stopImmediatePropagation()}function ja(e){return(!e.ctrlKey||e.type===`wheel`)&&!e.button}function Ma(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute(`viewBox`)?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Na(){return this.__zoom||Q}function Pa(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Fa(){return navigator.maxTouchPoints||`ontouchstart`in this}function Ia(e,t,n){var r=e.invertX(t[0][0])-n[0][0],i=e.invertX(t[1][0])-n[1][0],a=e.invertY(t[0][1])-n[0][1],o=e.invertY(t[1][1])-n[1][1];return e.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),o>a?(a+o)/2:Math.min(0,a)||Math.max(0,o))}function La(){var e=ja,t=Ma,n=Ia,r=Pa,i=Fa,a=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],s=250,c=yr,l=pe(`start`,`zoom`,`end`),u,d,f,p=500,m=150,h=0,g=10;function _(e){e.property(`__zoom`,Na).on(`wheel.zoom`,w,{passive:!1}).on(`mousedown.zoom`,T).on(`dblclick.zoom`,E).filter(i).on(`touchstart.zoom`,ee).on(`touchmove.zoom`,D).on(`touchend.zoom touchcancel.zoom`,te).style(`-webkit-tap-highlight-color`,`rgba(0,0,0,0)`)}_.transform=function(e,t,n,r){var i=e.selection?e.selection():e;i.property(`__zoom`,Na),e===i?i.interrupt().each(function(){S(this,arguments).event(r).start().zoom(null,typeof t==`function`?t.apply(this,arguments):t).end()}):x(e,t,n,r)},_.scaleBy=function(e,t,n,r){_.scaleTo(e,function(){var e=this.__zoom.k,n=typeof t==`function`?t.apply(this,arguments):t;return e*n},n,r)},_.scaleTo=function(e,r,i,a){_.transform(e,function(){var e=t.apply(this,arguments),a=this.__zoom,s=i==null?b(e):typeof i==`function`?i.apply(this,arguments):i,c=a.invert(s),l=typeof r==`function`?r.apply(this,arguments):r;return n(y(v(a,l),s,c),e,o)},i,a)},_.translateBy=function(e,r,i,a){_.transform(e,function(){return n(this.__zoom.translate(typeof r==`function`?r.apply(this,arguments):r,typeof i==`function`?i.apply(this,arguments):i),t.apply(this,arguments),o)},null,a)},_.translateTo=function(e,r,i,a,s){_.transform(e,function(){var e=t.apply(this,arguments),s=this.__zoom,c=a==null?b(e):typeof a==`function`?a.apply(this,arguments):a;return n(Q.translate(c[0],c[1]).scale(s.k).translate(typeof r==`function`?-r.apply(this,arguments):-r,typeof i==`function`?-i.apply(this,arguments):-i),e,o)},a,s)};function v(e,t){return t=Math.max(a[0],Math.min(a[1],t)),t===e.k?e:new Z(t,e.x,e.y)}function y(e,t,n){var r=t[0]-n[0]*e.k,i=t[1]-n[1]*e.k;return r===e.x&&i===e.y?e:new Z(e.k,r,i)}function b(e){return[(+e[0][0]+ +e[1][0])/2,(+e[0][1]+ +e[1][1])/2]}function x(e,n,r,i){e.on(`start.zoom`,function(){S(this,arguments).event(i).start()}).on(`interrupt.zoom end.zoom`,function(){S(this,arguments).event(i).end()}).tween(`zoom`,function(){var e=this,a=arguments,o=S(e,a).event(i),s=t.apply(e,a),l=r==null?b(s):typeof r==`function`?r.apply(e,a):r,u=Math.max(s[1][0]-s[0][0],s[1][1]-s[0][1]),d=e.__zoom,f=typeof n==`function`?n.apply(e,a):n,p=c(d.invert(l).concat(u/d.k),f.invert(l).concat(u/f.k));return function(e){if(e===1)e=f;else{var t=p(e),n=u/t[2];e=new Z(n,l[0]-t[0]*n,l[1]-t[1]*n)}o.zoom(null,e)}})}function S(e,t,n){return!n&&e.__zooming||new C(e,t)}function C(e,n){this.that=e,this.args=n,this.active=0,this.sourceEvent=null,this.extent=t.apply(e,n),this.taps=0}C.prototype={event:function(e){return e&&(this.sourceEvent=e),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit(`start`)),this},zoom:function(e,t){return this.mouse&&e!==`mouse`&&(this.mouse[1]=t.invert(this.mouse[0])),this.touch0&&e!==`touch`&&(this.touch0[1]=t.invert(this.touch0[0])),this.touch1&&e!==`touch`&&(this.touch1[1]=t.invert(this.touch1[0])),this.that.__zoom=t,this.emit(`zoom`),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit(`end`)),this},emit:function(e){var t=I(this.that).datum();l.call(e,this.that,new Da(e,{sourceEvent:this.sourceEvent,target:_,type:e,transform:this.that.__zoom,dispatch:l}),t)}};function w(t,...i){if(!e.apply(this,arguments))return;var s=S(this,i).event(t),c=this.__zoom,l=Math.max(a[0],Math.min(a[1],c.k*2**r.apply(this,arguments))),u=L(t);if(s.wheel)(s.mouse[0][0]!==u[0]||s.mouse[0][1]!==u[1])&&(s.mouse[1]=c.invert(s.mouse[0]=u)),clearTimeout(s.wheel);else if(c.k===l)return;else s.mouse=[u,c.invert(u)],Wr(this),s.start();Aa(t),s.wheel=setTimeout(d,m),s.zoom(`mouse`,n(y(v(c,l),s.mouse[0],s.mouse[1]),s.extent,o));function d(){s.wheel=null,s.end()}}function T(t,...r){if(f||!e.apply(this,arguments))return;var i=t.currentTarget,a=S(this,r,!0).event(t),s=I(t.view).on(`mousemove.zoom`,d,!0).on(`mouseup.zoom`,p,!0),c=L(t,i),l=t.clientX,u=t.clientY;mn(t.view),ka(t),a.mouse=[c,this.__zoom.invert(c)],Wr(this),a.start();function d(e){if(Aa(e),!a.moved){var t=e.clientX-l,r=e.clientY-u;a.moved=t*t+r*r>h}a.event(e).zoom(`mouse`,n(y(a.that.__zoom,a.mouse[0]=L(e,i),a.mouse[1]),a.extent,o))}function p(e){s.on(`mousemove.zoom mouseup.zoom`,null),hn(e.view,a.moved),Aa(e),a.event(e).end()}}function E(r,...i){if(e.apply(this,arguments)){var a=this.__zoom,c=L(r.changedTouches?r.changedTouches[0]:r,this),l=a.invert(c),u=a.k*(r.shiftKey?.5:2),d=n(y(v(a,u),c,l),t.apply(this,i),o);Aa(r),s>0?I(this).transition().duration(s).call(x,d,c,r):I(this).call(_.transform,d,c,r)}}function ee(t,...n){if(e.apply(this,arguments)){var r=t.touches,i=r.length,a=S(this,n,t.changedTouches.length===i).event(t),o,s,c,l;for(ka(t),s=0;s<i;++s)c=r[s],l=L(c,this),l=[l,this.__zoom.invert(l),c.identifier],a.touch0?!a.touch1&&a.touch0[2]!==l[2]&&(a.touch1=l,a.taps=0):(a.touch0=l,o=!0,a.taps=1+!!u);u&&=clearTimeout(u),o&&(a.taps<2&&(d=l[0],u=setTimeout(function(){u=null},p)),Wr(this),a.start())}}function D(e,...t){if(this.__zooming){var r=S(this,t).event(e),i=e.changedTouches,a=i.length,s,c,l,u;for(Aa(e),s=0;s<a;++s)c=i[s],l=L(c,this),r.touch0&&r.touch0[2]===c.identifier?r.touch0[0]=l:r.touch1&&r.touch1[2]===c.identifier&&(r.touch1[0]=l);if(c=r.that.__zoom,r.touch1){var d=r.touch0[0],f=r.touch0[1],p=r.touch1[0],m=r.touch1[1],h=(h=p[0]-d[0])*h+(h=p[1]-d[1])*h,g=(g=m[0]-f[0])*g+(g=m[1]-f[1])*g;c=v(c,Math.sqrt(h/g)),l=[(d[0]+p[0])/2,(d[1]+p[1])/2],u=[(f[0]+m[0])/2,(f[1]+m[1])/2]}else if(r.touch0)l=r.touch0[0],u=r.touch0[1];else return;r.zoom(`touch`,n(y(c,l,u),r.extent,o))}}function te(e,...t){if(this.__zooming){var n=S(this,t).event(e),r=e.changedTouches,i=r.length,a,o;for(ka(e),f&&clearTimeout(f),f=setTimeout(function(){f=null},p),a=0;a<i;++a)o=r[a],n.touch0&&n.touch0[2]===o.identifier?delete n.touch0:n.touch1&&n.touch1[2]===o.identifier&&delete n.touch1;if(n.touch1&&!n.touch0&&(n.touch0=n.touch1,delete n.touch1),n.touch0)n.touch0[1]=this.__zoom.invert(n.touch0[0]);else if(n.end(),n.taps===2&&(o=L(o,this),Math.hypot(d[0]-o[0],d[1]-o[1])<g)){var s=I(this).on(`dblclick.zoom`);s&&s.apply(this,arguments)}}}return _.wheelDelta=function(e){return arguments.length?(r=typeof e==`function`?e:Ea(+e),_):r},_.filter=function(t){return arguments.length?(e=typeof t==`function`?t:Ea(!!t),_):e},_.touchable=function(e){return arguments.length?(i=typeof e==`function`?e:Ea(!!e),_):i},_.extent=function(e){return arguments.length?(t=typeof e==`function`?e:Ea([[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]]),_):t},_.scaleExtent=function(e){return arguments.length?(a[0]=+e[0],a[1]=+e[1],_):[a[0],a[1]]},_.translateExtent=function(e){return arguments.length?(o[0][0]=+e[0][0],o[1][0]=+e[1][0],o[0][1]=+e[0][1],o[1][1]=+e[1][1],_):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},_.constrain=function(e){return arguments.length?(n=e,_):n},_.duration=function(e){return arguments.length?(s=+e,_):s},_.interpolate=function(e){return arguments.length?(c=e,_):c},_.on=function(){var e=l.on.apply(l,arguments);return e===l?_:e},_.clickDistance=function(e){return arguments.length?(h=(e=+e)*e,_):Math.sqrt(h)},_.tapDistance=function(e){return arguments.length?(g=+e,_):g},_}function Ra(e,t){if(e.id===t)return e;if(e.children)for(let n of e.children){let e=Ra(n,t);if(e)return e}return null}function $(e,t){if(!e.children)return null;for(let n of e.children){if(n.id===t)return e;let r=$(n,t);if(r)return r}return null}var za=`wbsChartData`,Ba=`wbsChartTheme`;function Va(){let e=d(null),t=d(null),r=d(!1),i=d(``),o=d(``),c=d([]),l=d(!1),u=d(null),f=d(null),p=d(``),m=d(``),h=d(null),g=d(null),_=d(null),v=d(null),y=d(null),b=d(Q),x=d(!1),S=d(``),C=d(``),w=d(!1),T=d(``),E=d(null),ee=s(()=>t.value?.depth===0),D=s(()=>t.value?.depth>=2);function te(){e.value&&localStorage.setItem(za,JSON.stringify(e.value))}function ne(){let t=localStorage.getItem(za);if(t)try{return e.value=JSON.parse(t),!0}catch(e){return console.error(`Failed to parse saved data:`,e),!1}return!1}function re(){e.value={name:`새 프로젝트`,id:crypto.randomUUID(),children:[]}}n(e,()=>{te()},{deep:!0});async function O(e,t,n=``){S.value=e,C.value=t,w.value=!0,T.value=n,x.value=!0,await a();let r=document.querySelector(`.modal input`);return r&&r.focus(),new Promise(e=>{E.value=e})}async function ie(e,t){return S.value=e,C.value=t,w.value=!1,x.value=!0,new Promise(e=>{E.value=e})}async function k(e,t){return S.value=e,C.value=t,w.value=!1,x.value=!0,new Promise(e=>{E.value=()=>{e()}})}function ae(){if(E.value){x.value=!1;let e=w.value?T.value:!0;E.value(e),E.value=null,T.value=``}}function oe(){if(E.value){x.value=!1;let e=w.value?null:!1;E.value(e),E.value=null,T.value=``}}function se(e){if(e.x=0,e.y=0,e.children){let t=-((e.children.length-1)*350)/2;e.children.forEach((n,r)=>{n.x=t+r*350,n.y=e.y+150,n.children&&n.children.forEach((e,t)=>{e.y=n.y+150*.8+t*100,e.x=n.x+130})})}}function ce(e,t){e.each(function(){let e=I(this),n=e.text().split(/\s+/).reverse();e.text(null);let r,i=[],a=[],o=1.1,s=e.append(`tspan`).attr(`x`,0);for(;r=n.pop();)i.push(r),s.text(i.join(` `)),s.node().getComputedTextLength()>t&&i.length>1&&(i.pop(),a.push(i.join(` `)),i=[r]);a.push(i.join(` `)),s.remove();let c=-((a.length-1)*o)/2;a.forEach((t,n)=>{e.append(`tspan`).attr(`x`,0).attr(`dy`,(n===0?c:o)+`em`).text(t)})})}function A(){if(!_.value||!e.value){console.warn(`Chart not ready:`,{g:!!_.value,data:!!e.value});return}_.value.selectAll(`*`).remove();let n=ya(e.value,e=>e.children);se(n);let r=n.links(),i=n.descendants(),a=l.value?`#4A5568`:`#CBD5E0`;_.value.selectAll(`.link`).data(r).enter().append(`path`).attr(`class`,`link`).style(`stroke`,a).attr(`d`,e=>{if(e.source.depth===0)return`M ${e.source.x},${e.source.y+60/2}L ${e.target.x},${e.target.y-60/2}`;let t=e.source.x,n=e.source.y+60/2,r=e.target.x-200/2,i=e.target.y;return`M ${t},${n} V ${i} H ${r}`});let o=l.value?{root:`#2D3748`,parent:`#1A202C`,leaf:`#1E293B`}:{root:`#E2E8F0`,parent:`#F1F5F9`,leaf:`#FFFFFF`},s=l.value?{root:`#718096`,default:`#4A5568`}:{root:`#4A5568`,default:`#A0AEC0`},c=l.value?`#E2E8F0`:`#2D3748`,u=_.value.selectAll(`.node`).data(i).enter().append(`g`).attr(`class`,`node`).attr(`transform`,e=>`translate(${e.x},${e.y})`).on(`click`,(e,n)=>{_.value.selectAll(`rect.selected`).classed(`selected`,!1),I(e.currentTarget).select(`rect`).classed(`selected`,!0),t.value=n,fe(n)});u.append(`rect`).attr(`width`,200).attr(`height`,60).attr(`x`,-200/2).attr(`y`,-60/2).attr(`rx`,5).style(`fill`,e=>e.depth===0?o.root:e.children?o.parent:o.leaf).style(`stroke`,e=>e.depth===0?s.root:s.default).classed(`selected`,e=>e.data.id===t.value?.data.id),u.append(`text`).style(`text-anchor`,`middle`).style(`fill`,c).text(e=>e.data.name.trim()).call(ce,180)}function le(t){if(!t){console.warn(`Chart container not provided`);return}if(v.value=t,I(t).selectAll(`svg`).remove(),g.value=I(t).append(`svg`).attr(`width`,`100%`).attr(`height`,`100%`).style(`cursor`,`grab`),_.value=g.value.append(`g`),y.value=La().scaleExtent([.1,3]).on(`zoom`,e=>{_.value&&(b.value=e.transform,_.value.attr(`transform`,e.transform))}).filter(e=>{let t=e.button===0||e.button===1;return(!e.ctrlKey||e.type===`wheel`)&&t}),g.value.call(y.value).on(`dblclick.zoom`,null),e.value)A(),a(()=>{setTimeout(()=>{j(t)},100)});else{let r=n(e,e=>{e&&(A(),a(()=>{setTimeout(()=>{j(t)},100)}),r())})}}function j(e){if(_.value&&_.value.node()&&g.value&&y.value)try{let t=_.value.node().getBBox(),n=e.clientWidth||window.innerWidth;e.clientHeight||window.innerHeight;let r=.6,i=n/2-(t.x+t.width/2)*r,a=Q.translate(i,100).scale(r);b.value=a,_.value&&_.value.attr(`transform`,a),y.value&&g.value&&g.value.call(y.value.transform,a)}catch(e){console.warn(`Failed to set initial zoom:`,e)}}function M(e,t){let n=ue(e,t);b.value=n,_.value&&_.value.attr(`transform`,n)}function ue(t,n){if(!_.value||!_.value.node()||!e.value||!n)return t;try{let e=_.value.node().getBBox();if(e.width===0&&e.height===0)return t;let r=n.clientWidth||window.innerWidth,i=n.clientHeight||window.innerHeight,a=e.width*t.k,o=e.height*t.k,s=t.x,c=t.y;if(a<r)s=(r-a)/2-e.x*t.k;else{let n=-e.x*t.k-a+r,i=-e.x*t.k;s=Math.max(n,Math.min(i,t.x))}if(o<i)c=(i-o)/2-e.y*t.k;else{let n=-e.y*t.k-o+i,r=-e.y*t.k;c=Math.max(n,Math.min(r,t.y))}return Q.translate(s,c).scale(t.k)}catch(e){return console.warn(`Failed to constrain transform:`,e),t}}function de(){if(!(!_.value||!_.value.node()||!g.value||!v.value))try{let e=_.value.node().getBBox(),t=v.value,n=t.clientWidth||window.innerWidth,r=t.clientHeight||window.innerHeight,i=n-100,a=r-100,o=i/e.width,s=a/e.height,c=Math.min(o,s,3),l=e.width*c,u=e.height*c,d=(n-l)/2-e.x*c,f=(r-u)/2-e.y*c,p=Q.translate(d,f).scale(c);M(p,t)}catch(e){console.warn(`Failed to fit to view:`,e)}}function fe(e){t.value=e,i.value=e.data.name,pe(e),r.value=!0}function pe(t){let n=new Set;function r(e){n.add(e.id),e.children&&e.children.forEach(r)}r(t.data);let i=[];function a(r,o=0){if(n.has(r.id))return;let s=`—`.repeat(o)+` `+r.name,c=$(e.value,t.data.id);i.push({id:r.id,label:s,selected:c&&c.id===r.id}),r.children&&r.children.forEach(e=>a(e,o+1))}a(e.value),c.value=i,o.value=i.find(e=>e.selected)?.id||``}function me(e){t.value=e,i.value=e.data.name,pe(e),r.value=!0}function N(){r.value=!1,t.value=null}function he(){if(!t.value)return;let n=Ra(e.value,t.value.data.id);if(!n)return;n.name=i.value.trim();let r=o.value,a=$(e.value,n.id);if(a&&a.id!==r){let t=Ra(e.value,r);t&&(a.children=a.children.filter(e=>e.id!==n.id),t.children||=[],t.children.push(n))}A()}async function ge(){if(!t.value)return;let n=await O(`자식 노드 추가`,`새 자식 노드의 이름을 입력하세요:`,``);if(n){let r=Ra(e.value,t.value.data.id);r.children||=[],r.children.push({name:n.trim(),id:crypto.randomUUID()}),A()}}async function _e(){if(!t.value)return;let n=$(e.value,t.value.data.id);if(!n){await k(`오류`,`루트 노드에는 형제 노드를 추가할 수 없습니다.`);return}let r=await O(`형제 노드 추가`,`새 형제 노드의 이름을 입력하세요:`,``);if(r){let e={name:r.trim(),id:crypto.randomUUID()},i=n.children.findIndex(e=>e.id===t.value.data.id);i>-1&&n.children.splice(i+1,0,e),A()}}async function ve(){if(t.value&&await ie(`노드 삭제`,`'${t.value.data.name}' 노드를 정말 삭제하시겠습니까? 모든 자식 노드도 함께 삭제됩니다.`)){let n=$(e.value,t.value.data.id);n?(n.children=n.children.filter(e=>e.id!==t.value.data.id),N(),A()):await k(`오류`,`루트 노드는 삭제할 수 없습니다.`)}}function ye(){let e=localStorage.getItem(Ba);e===`dark`||e===`light`?l.value=e===`dark`:l.value=window.matchMedia(`(prefers-color-scheme: dark)`).matches,xe()}function be(){l.value=!l.value,xe(),localStorage.setItem(Ba,l.value?`dark`:`light`),A()}function xe(){let e=l.value?`dark`:`light`;document.documentElement.setAttribute(`data-theme`,e),document.body.setAttribute(`data-theme`,e)}function Se(){let t=JSON.stringify(e.value,null,2),n=new Blob([t],{type:`application/json`}),r=URL.createObjectURL(n);p.value=r,m.value=`wbs-data.json`,a(()=>{f.value&&(f.value.click(),setTimeout(()=>{URL.revokeObjectURL(r),p.value=``,m.value=``},100))})}async function Ce(t){let n=t.target.files[0];if(!n)return;let r=new FileReader;r.onload=async t=>{try{let n=t.target.result,r=JSON.parse(n);if(r.name&&r.id)e.value=r,N(),A(),await k(`성공`,`JSON 데이터를 성공적으로 불러왔습니다.`);else throw Error(`Invalid JSON format. Missing 'name' or 'id' property.`)}catch(e){console.error(`Error parsing JSON:`,e),await k(`오류`,`JSON 파일을 불러오는 중 오류가 발생했습니다. 파일 형식을 확인해주세요.`)}},r.readAsText(n),h.value&&(h.value.value=``)}function we(){h.value?.click()}function Te(e,t,n){let r=e.cloneNode(!0);I(r).selectAll(`rect.selected`).classed(`selected`,!1);let i=I(r).select(`g`),a=document.createElement(`style`);return a.textContent=Array.from(document.styleSheets).map(e=>{try{return Array.from(e.cssRules).map(e=>e.cssText).join(`
`)}catch{return``}}).join(`
`),r.insertBefore(a,r.firstChild),I(r).attr(`width`,t.width+n*2).attr(`height`,t.height+n*2),i.attr(`transform`,`translate(${-t.x+n}, ${-t.y+n})`),new XMLSerializer().serializeToString(r)}async function Ee(){let e=r.value;if(e&&N(),await a(),!g.value||!_.value){console.warn(`Chart not ready for PNG export`);return}return new Promise(n=>{setTimeout(()=>{let r=g.value.node(),i=_.value.node().getBBox(),a=i.width+100,o=i.height+100,s=Te(r,i,50),c=document.createElement(`canvas`);c.width=a,c.height=o;let u=c.getContext(`2d`),d=new Image;d.onload=function(){u.fillStyle=l.value?`#1a1a1a`:`#f7fafc`,u.fillRect(0,0,a,o),u.drawImage(d,0,0);let r=document.createElement(`a`);r.download=`wbs-chart.png`,r.href=c.toDataURL(`image/png`),r.click(),e&&t.value&&me(t.value),n()},d.src=`data:image/svg+xml;base64,`+btoa(unescape(encodeURIComponent(s)))},100)})}function De(){document.addEventListener(`keydown`,e=>{(e.metaKey||e.ctrlKey)&&e.key===`s`&&(e.preventDefault(),e.shiftKey?Ee():Se()),(e.metaKey||e.ctrlKey)&&e.key===`o`&&(e.preventDefault(),we())})}function Oe(){ye(),window.matchMedia&&window.matchMedia(`(prefers-color-scheme: dark)`).addEventListener(`change`,e=>{localStorage.getItem(Ba)||(l.value=e.matches,xe(),A())}),ne()||re(),De()}return{hierarchicalData:e,selectedNode:t,isToolbarVisible:r,nodeNameInput:i,selectedParentId:o,parentOptions:c,isDarkMode:l,chartRef:u,downloadLink:f,downloadUrl:p,downloadFilename:m,fileInput:h,showModal:x,modalTitle:S,modalMessage:C,modalShowInput:w,modalInputValue:T,isRootNode:ee,isTaskOrLower:D,initializeChart:le,updateChart:A,handleNodeClick:fe,showEditToolbar:me,hideEditToolbar:N,saveChanges:he,addChild:ge,addSibling:_e,deleteNode:ve,showModalPrompt:O,showModalConfirm:ie,showModalAlert:k,handleModalOk:ae,handleModalCancel:oe,toggleDarkMode:be,exportJSON:Se,importJSON:we,handleFileImport:Ce,exportPNG:Ee,fitToView:de,initialize:Oe}}var Ha={class:`wbs-chart-app`},Ua=[`href`,`download`],Wa=b({__name:`index`,setup(n){let r=Va(),{hierarchicalData:i,selectedNode:o,isToolbarVisible:s,nodeNameInput:l,selectedParentId:u,parentOptions:d,isDarkMode:f,chartRef:p,downloadLink:h,downloadUrl:g,downloadFilename:_,fileInput:b,showModal:x,modalTitle:C,modalMessage:w,modalShowInput:T,modalInputValue:E,handleNodeClick:ee,hideEditToolbar:D,saveChanges:ne,addChild:re,addSibling:O,deleteNode:ie,handleModalOk:k,handleModalCancel:oe,toggleDarkMode:se,exportJSON:ce,importJSON:le,handleFileImport:j,exportPNG:M,fitToView:ue,initialize:de}=r,fe={initializeChart:r.initializeChart,updateChart:r.updateChart,exportPNG:r.exportPNG};return v(()=>{de(),a(()=>{p.value&&p.value.initializeChart&&p.value.initializeChart()})}),(n,a)=>(t(),c(`div`,Ha,[y(te,{"is-visible":e(s),"selected-node":e(o),"parent-options":e(d),"selected-parent-id":e(u),"node-name":e(l),"onUpdate:nodeName":a[0]||=e=>l.value=e,"onUpdate:selectedParentId":a[1]||=e=>u.value=e,onClose:e(D),onSave:e(ne),onAddChild:e(re),onAddSibling:e(O),onDelete:e(ie)},null,8,[`is-visible`,`selected-node`,`parent-options`,`selected-parent-id`,`node-name`,`onClose`,`onSave`,`onAddChild`,`onAddSibling`,`onDelete`]),y(ae,{"is-dark-mode":e(f),onToggleDarkMode:e(se),onImportJson:e(le),onExportJson:e(ce),onExportPng:e(M),onFitToView:e(ue)},null,8,[`is-dark-mode`,`onToggleDarkMode`,`onImportJson`,`onExportJson`,`onExportPng`,`onFitToView`]),y(S,{ref_key:`chartRef`,ref:p,"hierarchical-data":e(i),"selected-node":e(o),"is-dark-mode":e(f),"chart-instance":fe,onNodeClick:e(ee)},null,8,[`hierarchical-data`,`selected-node`,`is-dark-mode`,`onNodeClick`]),y(A,{"show-modal":e(x),"modal-title":e(C),"modal-message":e(w),"modal-show-input":e(T),"modal-input-value":e(E),"onUpdate:modalInputValue":a[2]||=t=>e(r).modalInputValue=t,onOk:e(k),onCancel:e(oe)},null,8,[`show-modal`,`modal-title`,`modal-message`,`modal-show-input`,`modal-input-value`,`onOk`,`onCancel`]),m(`a`,{ref_key:`downloadLink`,ref:h,href:e(g),download:e(_),style:{display:`none`}},null,8,Ua),m(`input`,{ref_key:`fileInput`,ref:b,type:`file`,accept:`.json,application/json`,style:{display:`none`},onChange:a[3]||=(...t)=>e(j)&&e(j)(...t)},null,544)]))}},[[`__scopeId`,`data-v-17ad64b0`]]);export{Wa as default};