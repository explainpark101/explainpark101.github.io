import{A as e,C as t,E as n,N as r,O as i,S as a,b as ee,d as o,f as s,g as c,h as l,i as te,j as u,k as d,l as ne,p as f,s as re,u as p,v as m,w as ie,x as ae}from"./index-CR2oTWUA.js";import{t as oe}from"./_plugin-vue_export-helper-9n1O4nl6.js";var se={class:`main-container`},ce={key:0},le={key:1},ue={key:2,id:`qrcode-container`,class:`qrcode-container`},de=[`href`],fe={key:4,class:`room-id-display`},pe={class:`status-container`},me={id:`status-text`},he={key:5,class:`witty-message`},ge={class:`video-main`},_e={class:`video-header`},ve={class:`video-header-title`},ye={class:`video-header-actions`},be=[`title`],xe={key:0,class:`w-6 h-6`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`},Se={key:1,class:`w-6 h-6`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`},Ce={class:`video-container`},we={class:`remote-video-wrapper`},Te={key:0,class:`video-placeholder`},Ee={class:`local-video-wrapper`},De={key:0,class:`screen-share-badge`},Oe={key:0,class:`audio-indicator`},ke={key:1,class:`camera-indicator`},Ae={key:1,class:`video-placeholder-small`},je={class:`sidebar-section`},Me={key:0,class:`message-name`},Ne={class:`text-xs text-gray-400`},Pe={class:`message-text`},Fe={class:`message-time`},Ie={class:`sidebar-section`},Le={id:`qrcode-chat-container`,class:`qrcode-chat-container`},Re=[`href`],ze={class:`sidebar-section`},Be={id:`guest-list`,class:`guest-list`},Ve={class:`guest-item host`},He={class:`text-xs text-gray-400`},Ue={key:0},We={key:1},Ge={class:`text-xs text-gray-400`},Ke={key:0},qe={class:`modal-content`},Je={class:`modal-actions`},Ye={class:`modal-content`},Xe={class:`screen-share-options`},Ze={class:`option-checkbox`},Qe={class:`option-checkbox`},$e={class:`modal-content audio-volume-modal-content`},et={key:0,class:`audio-tracks-list`},tt={class:`audio-track-label`},nt={class:`track-name`},rt={class:`track-volume`},it=[`value`,`onInput`],at={key:1,class:`no-audio-tracks`},h=oe({__name:`index`,setup(oe){let h=d(`home`),ot=d(``),g=d(``),_=d(!1),v=d(null),y=d(null),b=d(null),x=d(null),S=d(``),st=d(``),ct=d(!1),lt=d(``),ut=d(``),dt=d(!1),C=d(null),w=d(!0),T=d(null),ft=d(null),E=d(null),D=d(null),O=d(null),k=d(null),A=d(null),j=d(null),M=d(!1),N=d(null),P=d(null),F=d([]),pt=d(!1),I=d({includeAudio:!1,keepCamera:!1}),mt=d(!1),L=new Map,R=d(null),z=null,B=new Map,V=new Map,H=new Map,U=d(null),W=null,G=d(null),K=d(null),q=d([]),J=null,Y=null,X=null,Z=`ì˜ì—­ ì „ê°œ ì¤‘...(ì£¼ìˆ ì „ë¬¸ê³  í•™ìƒë“¤ì˜ ì‘ì›ì„ ë°›ëŠ” ì¤‘...(ì´íƒ€ë„ë¦¬ ìœ ì§€ê°€ ì£¼ë¬¼ì„ ì‚¼í‚¤ëŠ” ì¤‘...(ì˜·ì½”ì¸  ìœ íƒ€ê°€ ë¦¬ì¹´ì˜ ì €ì£¼ë¥¼ í‘¸ëŠ” ì¤‘...(ì „ì§‘ì¤‘ í˜¸í¡ ìµíˆëŠ” ì¤‘...(ë¹ˆí‹ˆì˜ ì‹¤ì„ ì°¾ëŠ” ì¤‘...(é›·ì˜ å‘¼å¸, å£±ãƒå‹, éœ¹é‚ä¸€é–ƒ!(ë”ìš± ë” ê·¸ ë„˜ì–´ë¡œ! Plus Ultra!(ê³ ë¬´ê³ ë¬´! ë¹ ë¥´ê²Œ ê¸°ë‹¤ë¦¬ê¸°!(ì œí•˜í•˜í•˜!!! ì´ ë¡œë”© ì†ë„ëŠ” ë­ëƒ!!!(ì¡°ë¡œê°€ ë¹ ë¥´ê²Œ ê¸¸ì„ ì°¾ê³  ìˆëŠ” ì¤‘...(ìˆ˜ë‘”! ê¸°ë‹¤ë¦¬ê¸°ì˜ ìˆ !(ì¸í„°ë„·ì´ ì—†ëŠ” ê³³ì—ì„œ ì´ ì •ë„ì˜ ë°ì´í„°ëŸ‰ì´ë¼ë‹ˆ í¬í‘!!(ì±„íŒ…ì›Œë“œ...ì˜¤...ë¹ ...(íƒ€ì½”í”¼ê°€ ë‹¹ì‹ ì„ í•´í”¼í•˜ê²Œ ë§Œë“¤ ë°©ë²•ì„ ê³ ë¯¼í•˜ëŠ” ì¤‘...(ì‹œì¦ˆì¹´ì˜ ë¯¸ì†Œë¥¼ ë³´ê¸° ìœ„í•´, ì‚¬ì§„ì„ ì°ëŠ” ì¤‘...(íƒ€ì½”í”¼ê°€ ì¹œêµ¬ì™€ í™”í•´í•˜ê¸°ë¥¼ ë°”ë¼ë©° ë¦¬ë³¸ì„ ì°¾ëŠ” ì¤‘...(ì•„ë§ˆë¯¸ì•¼ ì†Œë¼ê°€ ì‰ì—¬ì—¬ì‹  ì—°ê¸°ë¥¼ ì¤€ë¹„í•˜ëŠ” ì¤‘...(ì´ì¹˜íˆë©”ê°€ í™”ë£Œ ì§ì „ ë”°ë´‰ì„ ì¤€ë¹„í•˜ëŠ” ì¤‘...(ë„ëŒ€ì²´ ì–¸ì œë¶€í„° ì„œë²„ê°€ í„°ì¡Œë‹¤ê³  ìƒê°í•œ ê±°ì§€?(íŠ¸ë˜í”½ì„, íŠ¸ë˜í”½ì„ ë†’ì´ì§€ ë§ˆë¼(ë” ê³µì—°ì„ ì¶•í•˜í•˜ê¸° ìœ„í•´ í˜„ê´€ ì•ì—ì„œ ê½ƒ ë“¤ê³  ëŒ€ê¸° ì¤‘...(ë¦¬ì¹˜ ì¼ë°œ ë„ë¼3 ë’·ë„ë¼ 3 í˜¼ì¼ìƒ‰ ì‚°ì•ˆì»¤ << ì§„ì§œ ì‚¬ê¸°ì¹˜ë„¤ ã…‹ã…‹(ì™œ ë§ˆì‘ë¶€ì¥ì´ ë‹¤ìŒ ì‹¬í™” ê°•ì˜ë¥¼ ì°ëŠ” ì¤‘...(íšŒì¥ì´ ì¢…ì‹  ì„ ì–¸ë¬¸ì„ ì‘ì„±í•˜ëŠ” ì¤‘...(ëŒ€í•™ì›ìƒì´ ì—°êµ¬ì‹¤ì—ì„œ ë¹¨ë¦¬ ë‚˜ê°€ê¸°ë¥¼ ë°”ë¼ë©° ëŒ€ê¸° ì¤‘...`.split(`(`),ht=s(()=>Array.from(V.entries()).map(([e,{name:t,shortId:n}])=>({id:e,name:t,shortId:n}))),gt=s(()=>[...q.value].sort((e,t)=>new Date(e.timestamp)-new Date(t.timestamp))),_t=s(()=>_.value?`${y.value}ë‹˜ì˜ í™”ìƒí†µí™”`:G.value?`${G.value}ë‹˜ì˜ í™”ìƒí†µí™”`:`í˜¸ìŠ¤íŠ¸ ì •ë³´ ê¸°ë‹¤ë¦¬ëŠ” ì¤‘...`),vt=s(()=>_.value?U.value:U.value||(x.value?`${window.location.origin}${window.location.pathname}#${x.value}`:``)),yt=d(new Map),bt=s(()=>{if(!A.value)return[];let e=[];return A.value.getAudioTracks().forEach(t=>{let n=`ì˜¤ë””ì˜¤ íŠ¸ë™`;n=F.value.some(e=>e.id===t.id)?`í™”ë©´ ê³µìœ  ì˜¤ë””ì˜¤`:`ì›¹ìº  ë§ˆì´í¬`,yt.value.has(t.id)||yt.value.set(t.id,1);let r=yt.value.get(t.id);e.push({track:t,label:n,volume:r})}),e});function xt(e){return e.slice(-6)}function St(){J&&clearInterval(J);let e=``,t=()=>{let t=``;if(Z.length>1)do t=Z[Math.floor(Math.random()*Z.length)];while(t===e);else Z.length===1&&(t=Z[0]);st.value=t,e=t};t(),J=setInterval(t,2e3)}function Q(e){J&&=(clearInterval(J),null),h.value=e,ee(()=>{if(e===`home`){let e=document.getElementById(`username-input`);e&&e.focus()}else if(e===`video`){let e=document.getElementById(`message-input`);e&&e.focus(),window.innerWidth>768?w.value=!1:w.value=!0}})}function $(e,t,n=null){lt.value=e,ut.value=t,dt.value=!!n,C.value=n,ct.value=!0}function Ct(){ct.value=!1,C.value=null}function wt(){C.value&&C.value(),Ct()}function Tt(){I.value={includeAudio:!1,keepCamera:!1},pt.value=!0}function Et(){pt.value=!1}function Dt(){Et(),Rt(I.value)}function Ot(){R.value||=new(window.AudioContext||window.webkitAudioContext),A.value&&A.value.getAudioTracks().forEach(e=>{L.has(e.id)||At(e)}),mt.value=!0}function kt(){mt.value=!1}function At(e){R.value||=new(window.AudioContext||window.webkitAudioContext);try{let t=R.value.createMediaStreamSource(new MediaStream([e])),n=R.value.createGain();n.gain.value=1,t.connect(n),n.connect(R.value.destination),L.set(e.id,n)}catch(e){console.error(`ì˜¤ë””ì˜¤ íŠ¸ë™ GainNode ì„¤ì • ì‹¤íŒ¨:`,e)}}function jt(e,t){yt.value.set(e.id,t);let n=L.get(e.id);if(n)n.gain.value=t;else{At(e);let n=L.get(e.id);n&&(n.gain.value=t)}}function Mt(e){return new Date(e).toLocaleTimeString(`ko-KR`,{hour:`2-digit`,minute:`2-digit`})}function Nt(e,t=null){for(let[n,r]of B)if(n!==t)try{r.send(e)}catch(e){console.error(`Peer ${n}ë¡œ ì „ì†¡ ì‹¤íŒ¨:`,e)}}function Pt(){let e=Array.from(V.entries()).map(([e,{name:t,shortId:n}])=>({id:e,name:t,shortId:n})),t={type:`participantUpdate`,payload:{hostName:y.value,hostShortId:b.value,guests:e}};Nt(t)}function Ft(){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){let e=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;if(!e)return{supported:!1,error:`ì´ ë¸Œë¼ìš°ì €ëŠ” ë¯¸ë””ì–´ ë””ë°”ì´ìŠ¤ APIë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.`};navigator.mediaDevices={getUserMedia:t=>new Promise((n,r)=>{e.call(navigator,t,n,r)})}}return{supported:!0}}async function It(){try{let e=Ft();if(!e.supported)return $(`ë¯¸ë””ì–´ ì ‘ê·¼ ì‹¤íŒ¨`,e.error||`ì´ ë¸Œë¼ìš°ì €ëŠ” ì¹´ë©”ë¼/ë§ˆì´í¬ ì ‘ê·¼ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.`),null;let t=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:1920},height:{ideal:1080},frameRate:{ideal:30},facingMode:`user`},audio:{sampleRate:48e3,echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}});return A.value=t,O.value&&(O.value.srcObject=t),t}catch(e){return console.error(`ë¯¸ë””ì–´ ìŠ¤íŠ¸ë¦¼ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:`,e),$(`ë¯¸ë””ì–´ ì ‘ê·¼ ì‹¤íŒ¨`,`ì¹´ë©”ë¼/ë§ˆì´í¬ ì ‘ê·¼ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ${e.message}`),null}}function Lt(){A.value&&=(A.value.getTracks().forEach(e=>e.stop()),null),j.value&&=(j.value.getTracks().forEach(e=>e.stop()),null),N.value&&=(N.value.getTracks().forEach(e=>e.stop()),null),O.value&&(O.value.srcObject=null),k.value&&(k.value.srcObject=null),M.value=!1}async function Rt(e={includeAudio:!1,keepCamera:!1}){try{if(!navigator.mediaDevices||!navigator.mediaDevices.getDisplayMedia){$(`í™”ë©´ ê³µìœ  ì‹¤íŒ¨`,`ì´ ë¸Œë¼ìš°ì €ëŠ” í™”ë©´ ê³µìœ ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ìµœì‹  ë¸Œë¼ìš°ì €ë¥¼ ì‚¬ìš©í•´ì£¼ì„¸ìš”.`);return}let t=await navigator.mediaDevices.getDisplayMedia({video:{cursor:`always`},audio:e.includeAudio||!1});if(N.value=t,M.value=!0,F.value=[],e.includeAudio&&t.getAudioTracks().length>0&&t.getAudioTracks().forEach(e=>{F.value.push(e)}),!A.value)A.value=t,O.value&&(O.value.srcObject=t);else{let n=t.getVideoTracks()[0],r=A.value.getVideoTracks()[0];e.keepCamera&&r?(P.value=r,A.value.removeTrack(r),A.value.addTrack(n)):(r&&(A.value.removeTrack(r),r.stop()),A.value.addTrack(n)),e.includeAudio&&F.value.length>0&&F.value.forEach(e=>{A.value.getAudioTracks().find(t=>t.id===e.id)||A.value.addTrack(e)}),O.value&&(O.value.srcObject=A.value)}if(A.value){let t=A.value.getVideoTracks()[0];for(let[n,r]of H)try{let n=r?.peerConnection||r?._pc;if(n){let r=n.getSenders().find(e=>e.track&&e.track.kind===`video`);r&&await r.replaceTrack(t),e.includeAudio&&F.value.length>0&&F.value.forEach(e=>{n.getSenders().find(t=>t.track&&t.track.id===e.id)||n.addTrack(e,A.value)})}}catch(e){console.error(`í”¼ì–´ ${n}ì—ê²Œ íŠ¸ë™ êµì²´ ì‹¤íŒ¨:`,e)}}t.getVideoTracks()[0].onended=()=>{zt()}}catch(e){console.error(`í™”ë©´ ê³µìœ  ì‹¤íŒ¨:`,e),e.name===`NotAllowedError`||e.name===`PermissionDeniedError`?$(`í™”ë©´ ê³µìœ  ê¶Œí•œ ê±°ë¶€`,`í™”ë©´ ê³µìœ  ê¶Œí•œì´ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì € ì„¤ì •ì—ì„œ ê¶Œí•œì„ í—ˆìš©í•´ì£¼ì„¸ìš”.`):e.name===`NotFoundError`?$(`í™”ë©´ ê³µìœ  ì‹¤íŒ¨`,`ê³µìœ í•  ìˆ˜ ìˆëŠ” í™”ë©´ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`):$(`í™”ë©´ ê³µìœ  ì‹¤íŒ¨`,`í™”ë©´ ê³µìœ  ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${e.message}`),M.value=!1,F.value=[]}}async function zt(){if(M.value)try{if(!A.value){M.value=!1;return}let e=A.value.getVideoTracks().find(e=>N.value&&N.value.getVideoTracks().some(t=>t.id===e.id));e&&(A.value.removeTrack(e),e.stop());let t=[...F.value];if(t.length>0&&t.forEach(e=>{let t=A.value.getAudioTracks().find(t=>t.id===e.id);t&&A.value.removeTrack(t),e.stop()}),N.value&&=(N.value.getTracks().forEach(e=>{e.readyState!==`ended`&&e.stop()}),null),P.value&&P.value.readyState!==`ended`){let e=A.value.getVideoTracks()[0];e?e.id!==P.value.id&&(A.value.removeTrack(e),e.stop(),A.value.addTrack(P.value)):A.value.addTrack(P.value),P.value=null}else await Bt();for(let[e,n]of H)try{let e=n?.peerConnection||n?._pc;if(e){t.length>0&&e.getSenders().forEach(n=>{n.track&&t.some(e=>e.id===n.track.id)&&e.removeTrack(n)});let n=A.value.getVideoTracks()[0];if(n){let t=e.getSenders().find(e=>e.track&&e.track.kind===`video`);t&&await t.replaceTrack(n)}}}catch(t){console.error(`í”¼ì–´ ${e}ì—ê²Œ íŠ¸ë™ ì œê±° ì‹¤íŒ¨:`,t)}O.value&&(O.value.srcObject=A.value),F.value=[],M.value=!1}catch(e){console.error(`í™”ë©´ ê³µìœ  ì¤‘ì§€ ì‹¤íŒ¨:`,e),$(`ì˜¤ë¥˜`,`í™”ë©´ ê³µìœ ë¥¼ ì¤‘ì§€í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.`),M.value=!1}}async function Bt(){try{let e=Ft();if(!e.supported){$(`ì¹´ë©”ë¼ ì ‘ê·¼ ì‹¤íŒ¨`,e.error||`ì´ ë¸Œë¼ìš°ì €ëŠ” ì¹´ë©”ë¼ ì ‘ê·¼ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.`);return}let t=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:1920},height:{ideal:1080},frameRate:{ideal:30},facingMode:`user`},audio:{sampleRate:48e3,echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}});if(A.value){let e=t.getVideoTracks()[0],n=A.value.getVideoTracks().find(e=>e.kind===`video`);n&&(A.value.removeTrack(n),n.stop()),A.value.addTrack(e)}else A.value=t;if(O.value&&(O.value.srcObject=A.value),t.getAudioTracks().length>0&&A.value){let e=t.getAudioTracks()[0],n=A.value.getAudioTracks()[0];n&&(A.value.removeTrack(n),n.stop()),A.value.addTrack(e)}for(let[e,t]of H)try{let e=t?.peerConnection||t?._pc;if(e&&A.value){let t=A.value.getVideoTracks()[0];if(t){let n=e.getSenders().find(e=>e.track&&e.track.kind===`video`);n&&await n.replaceTrack(t)}let n=A.value.getAudioTracks()[0];if(n){let t=e.getSenders().find(e=>e.track&&e.track.kind===`audio`);t?await t.replaceTrack(n):e.addTrack(n,A.value)}}}catch(t){console.error(`í”¼ì–´ ${e}ì—ê²Œ íŠ¸ë™ êµì²´ ì‹¤íŒ¨:`,t)}}catch(e){console.error(`ì¹´ë©”ë¼ ì „í™˜ ì‹¤íŒ¨:`,e),$(`ì¹´ë©”ë¼ ì ‘ê·¼ ì‹¤íŒ¨`,`ì¹´ë©”ë¼ì— ì ‘ê·¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤: ${e.message}`)}}function Vt(e,t){if(!(!e||!e.type))if(_.value)switch(e.type){case`name`:V.set(t,{name:e.payload.name,shortId:e.payload.shortId}),B.get(t).send({type:`name`,payload:{name:y.value,shortId:b.value},id:v.value}),B.get(t).send({type:`roomInfo`,payload:{roomUrl:U.value}}),Pt();break;case`chat`:let n=V.get(t)||{name:`ì•Œ ìˆ˜ ì—†ëŠ” ì‚¬ìš©ì`,shortId:`??????`},r={text:e.payload,displayName:n.name,shortId:n.shortId,timestamp:e.timestamp,type:`chat`,senderId:t};q.value.push(r),Nt({type:`chat`,payload:e.payload,timestamp:e.timestamp,sender:{id:t,name:n.name,shortId:n.shortId}},t);break}else switch(e.type){case`name`:G.value=e.payload.name,K.value=e.payload.shortId;break;case`roomInfo`:U.value=e.payload.roomUrl,D.value&&window.QRCode&&(X&&=(X.clear(),null),D.value.innerHTML=``,X=new window.QRCode(D.value,{text:e.payload.roomUrl,width:160,height:160}));break;case`participantUpdate`:G.value=e.payload.hostName,K.value=e.payload.hostShortId;break;case`chat`:q.value.push({text:e.payload,displayName:e.sender.name,shortId:e.sender.shortId,timestamp:e.timestamp,type:`chat`,senderId:e.sender.id});break}}function Ht(e){e.on(`open`,()=>{if(console.log(`ë°ì´í„° ì±„ë„ ì—´ë¦¼: ${e.peer}`),_.value){if(A.value){let t=z.call(e.peer,A.value);t&&(H.set(e.peer,t),Ut(t,e.peer))}Q(`video`)}else{W=e;let t={type:`name`,payload:{name:y.value,shortId:b.value},id:v.value};if(W.send(t),A.value){let e=z.call(x.value,A.value);e&&(H.set(x.value,e),Ut(e,x.value))}Q(`video`)}}),e.on(`data`,t=>{Vt(t,e.peer)}),e.on(`close`,()=>{if(console.log(`ì—°ê²° ì¢…ë£Œ: ${e.peer}`),_.value){let t=e.peer;B.delete(t),V.delete(t);let n=H.get(t);n&&(n.close(),H.delete(t)),Pt()}else{e.kicked||$(`í˜¸ìŠ¤íŠ¸ ì—°ê²° ëŠê¹€`,`í˜¸ìŠ¤íŠ¸ì™€ì˜ ì—°ê²°ì´ ëŠì–´ì¡ŒìŠµë‹ˆë‹¤.`),W=null;let t=H.get(x.value);t&&(t.close(),H.delete(x.value))}}),e.on(`error`,t=>{console.error(`ì—°ê²° ì—ëŸ¬:`,t),_.value?$(`ê²ŒìŠ¤íŠ¸ ì—°ê²° ì˜¤ë¥˜`,`${e.peer}ì™€ ì—°ê²° ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ${t.message}`):$(`ì—°ê²° ì˜¤ë¥˜`,`ì˜¤ë¥˜ ë°œìƒ: ${t.message}`)})}function Ut(e,t){e.on(`stream`,e=>{console.log(`ì›ê²© ìŠ¤íŠ¸ë¦¼ ìˆ˜ì‹ :`,t),j.value=e,k.value&&(k.value.srcObject=e)}),e.on(`close`,()=>{console.log(`ë¯¸ë””ì–´ í˜¸ì¶œ ì¢…ë£Œ:`,t),j.value&&=(j.value.getTracks().forEach(e=>e.stop()),null),k.value&&(k.value.srcObject=null),H.delete(t)}),e.on(`error`,e=>{console.error(`ë¯¸ë””ì–´ í˜¸ì¶œ ì—ëŸ¬:`,e),$(`ë¯¸ë””ì–´ ì—°ê²° ì˜¤ë¥˜`,`ë¯¸ë””ì–´ ìŠ¤íŠ¸ë¦¼ êµí™˜ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ${e.message}`)})}function Wt(){Q(`waiting`),St(),S.value=`Peer ì„œë²„ì— ì—°ê²° ì¤‘...`,z=new window.Peer(null,{debug:2,host:`peerjs.jaehyung101.synology.me`,secure:!0,proxied:!0}),z.on(`open`,async e=>{v.value=e,b.value||(b.value=xt(v.value),sessionStorage.setItem(`webrtc-shortId`,b.value)),console.log(`ë‚´ Peer ID (í˜¸ìŠ¤íŠ¸): ${v.value} (#${b.value})`);let t=`${window.location.origin}${window.location.pathname}#${v.value}`;if(U.value=t,S.value=`ë¯¸ë””ì–´ ìŠ¤íŠ¸ë¦¼ ì¤€ë¹„ ì¤‘...`,!await It()){Q(`home`);return}S.value=`ìƒëŒ€ë°©ì˜ ì—°ê²°ì„ ê¸°ë‹¤ë¦¬ëŠ” ì¤‘...`,E.value&&window.QRCode&&(Y&&=(Y.clear(),null),E.value.innerHTML=``,Y=new window.QRCode(E.value,{text:t,width:256,height:256})),D.value&&window.QRCode&&(X&&=(X.clear(),null),D.value.innerHTML=``,X=new window.QRCode(D.value,{text:t,width:160,height:160}))}),z.on(`connection`,e=>{console.log(`ìƒˆ ì—°ê²° ì‹œë„: ${e.peer}`),B.set(e.peer,e),Ht(e)}),z.on(`call`,e=>{console.log(`ë¯¸ë””ì–´ í˜¸ì¶œ ìˆ˜ì‹ :`,e.peer),A.value&&(e.answer(A.value),H.set(e.peer,e),Ut(e,e.peer))}),z.on(`error`,e=>{console.error(`Peer ì—ëŸ¬:`,e),$(`ì—°ê²° ì‹¤íŒ¨`,`Peer ì„œë²„ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ${e.message}`),Lt(),Q(`home`)})}function Gt(e){Q(`waiting`),St(),S.value=`í˜¸ìŠ¤íŠ¸ì— ì—°ê²° ì¤‘...`,z=new window.Peer(null,{debug:3,host:`peerjs.jaehyung101.synology.me`,secure:!0,proxied:!0}),z.on(`open`,async t=>{if(v.value=t,b.value||(b.value=xt(v.value),sessionStorage.setItem(`webrtc-shortId`,b.value)),console.log(`ë‚´ Peer ID (ê²ŒìŠ¤íŠ¸): ${t} (#${b.value})`),S.value=`ë¯¸ë””ì–´ ìŠ¤íŠ¸ë¦¼ ì¤€ë¹„ ì¤‘...`,!await It()){Q(`home`);return}S.value=`í˜¸ìŠ¤íŠ¸ì— ì—°ê²° ì¤‘...`;let n=z.connect(e,{reliable:!0});if(!n){console.error(`í˜¸ìŠ¤íŠ¸ì— ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`),$(`ì—°ê²° ì‹¤íŒ¨`,`í˜¸ìŠ¤íŠ¸ì— ì—°ê²°ì„ ì‹œë„í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`),Lt(),Q(`home`);return}Ht(n)}),z.on(`call`,e=>{console.log(`ë¯¸ë””ì–´ í˜¸ì¶œ ìˆ˜ì‹ :`,e.peer),A.value&&(e.answer(A.value),H.set(e.peer,e),Ut(e,e.peer))}),z.on(`error`,e=>{console.error(`Peer ì—ëŸ¬:`,e);let t=`Peer ì˜¤ë¥˜: ${e.message}`;e.type===`peer-unavailable`&&(t=`í•´ë‹¹ ë£¸ IDë¥¼ ì°¾ì„ ìˆ˜ ì—†ê±°ë‚˜ í˜¸ìŠ¤íŠ¸ê°€ ì˜¤í”„ë¼ì¸ì…ë‹ˆë‹¤.`),$(`ì—°ê²° ì‹¤íŒ¨`,t),Lt(),window.location.hash=``,Q(`home`)})}function Kt(){let e=ot.value.trim();if(!e){$(`ì´ë¦„ í•„ìš”`,`í™”ìƒí†µí™”ì—ì„œ ì‚¬ìš©í•  ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”.`);return}y.value=e,_.value?Wt():Gt(x.value)}function qt(){let e=g.value.trim();if(!e)return;let t=new Date().toISOString(),n={text:e,displayName:y.value,shortId:b.value,timestamp:t,type:`chat`,senderId:v.value};q.value.push(n),g.value=``;let r={type:`chat`,payload:e,timestamp:t,sender:{id:v.value,name:y.value,shortId:b.value}};_.value?Nt(r):W&&W.open&&W.send(r)}function Jt(){w.value=!w.value}function Yt(e){return e.preventDefault(),e.returnValue=`ì •ë§ ë‚˜ê°€ì‹œê² ìŠµë‹ˆê¹Œ?`,`ì •ë§ ë‚˜ê°€ì‹œê² ìŠµë‹ˆê¹Œ?`}function Xt(e){return new Promise((t,n)=>{if(document.querySelector(`script[src="${e}"]`)){t();return}let r=document.createElement(`script`);r.src=e,r.onload=t,r.onerror=n,document.head.appendChild(r)})}function Zt(){document.title=`ezlive`,document.querySelectorAll(`meta[name="description"], meta[name="keywords"], meta[property^="og:"], meta[name^="twitter:"], meta[name="theme-color"], meta[name="apple-mobile-web-app-title"]`).forEach(e=>e.remove());let e=[{name:`description`,content:`ì„œë²„ ì—†ì´ QR ì½”ë“œë¡œ ì—°ê²°í•˜ëŠ” P2P í™”ìƒí†µí™” ì•±. ezliveë¡œ ì‰½ê³  ë¹ ë¥´ê²Œ í™”ìƒí†µí™”ë¥¼ ì‹œì‘í•˜ì„¸ìš”.`},{name:`keywords`,content:`í™”ìƒí†µí™”, WebRTC, P2P, QRì½”ë“œ, ë¹„ë””ì˜¤ì±„íŒ…, í™”ìƒíšŒì˜, ezlive`},{name:`theme-color`,content:`#111827`},{name:`apple-mobile-web-app-title`,content:`ezlive`},{name:`apple-mobile-web-app-capable`,content:`yes`},{name:`apple-mobile-web-app-status-bar-style`,content:`black-translucent`},{name:`viewport`,content:`width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no`}],t=[{property:`og:title`,content:`ezlive - P2P í™”ìƒí†µí™”`},{property:`og:description`,content:`ì„œë²„ ì—†ì´ QR ì½”ë“œë¡œ ì—°ê²°í•˜ëŠ” P2P í™”ìƒí†µí™” ì•±`},{property:`og:type`,content:`website`},{property:`og:url`,content:window.location.href},{property:`og:site_name`,content:`ezlive`}],n=[{name:`twitter:card`,content:`summary_large_image`},{name:`twitter:title`,content:`ezlive - P2P í™”ìƒí†µí™”`},{name:`twitter:description`,content:`ì„œë²„ ì—†ì´ QR ì½”ë“œë¡œ ì—°ê²°í•˜ëŠ” P2P í™”ìƒí†µí™” ì•±`}],r=e=>{let t=document.createElement(`meta`);Object.keys(e).forEach(n=>{n===`property`?t.setAttribute(`property`,e[n]):t.setAttribute(n,e[n])}),document.head.appendChild(t)};[...e,...t,...n].forEach(e=>r(e))}return n(q,()=>{ee(()=>{T.value&&(T.value.scrollTop=T.value.scrollHeight)})}),ae(async()=>{Zt();try{await Promise.all([Xt(`https://cdn.tailwindcss.com`),Xt(`https://unpkg.com/peerjs@1.5.4/dist/peerjs.min.js`),Xt(`https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js`)])}catch(e){console.error(`ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ ì‹¤íŒ¨:`,e),$(`ë¡œë“œ ì˜¤ë¥˜`,`í•„ìˆ˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë¡œë“œí•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.`)}b.value=sessionStorage.getItem(`webrtc-shortId`),window.location.hash?(x.value=window.location.hash.substring(1),_.value=!1):_.value=!0,Q(`home`)}),a(()=>{J&&clearInterval(J),Lt(),z&&z.destroy(),Y&&=(Y.clear(),null),X&&=(X.clear(),null)}),(n,a)=>(t(),c(`div`,{class:`webrtc-video-app`,onBeforeunload:Yt},[f(`div`,se,[f(`div`,{id:`home-view`,class:u([`home-view`,{hidden:h.value!==`home`}])},[f(`h1`,null,[a[5]||=m(`EZ WebRTC í™”ìƒ ì†”ë£¨ì…˜ `,-1),_.value?(t(),c(o,{key:0},[m(` (êµì‚¬ìš©) `)],64)):(t(),c(o,{key:1},[m(` (í•™ìƒìš©) `)],64))]),a[6]||=f(`p`,null,`ì„œë²„ ì—†ì´ QR ì½”ë“œë¡œ ì—°ê²°í•˜ëŠ” P2P í™”ìƒí†µí™”`,-1),i(f(`input`,{id:`username-input`,"onUpdate:modelValue":a[0]||=e=>ot.value=e,type:`text`,placeholder:`ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”...`,onKeydown:ne(Kt,[`enter`]),autocomplete:`off`,autocapitalize:`off`},null,544),[[re,ot.value]]),f(`button`,{id:`start-btn`,onClick:Kt},r(_.value?`ìƒˆ í™”ìƒí†µí™” ë§Œë“¤ê¸°`:`í™”ìƒí†µí™” ì°¸ì—¬í•˜ê¸°`),1)],2),f(`div`,{id:`waiting-view`,class:u([`waiting-view`,{hidden:h.value!==`waiting`}])},[_.value?(t(),c(`h2`,ce,`í™”ìƒí†µí™”ë°© ìƒì„±ë¨`)):l(``,!0),_.value?(t(),c(`p`,le,`ì•„ë˜ QR ì½”ë“œë¥¼ ìƒëŒ€ë°©ì´ ìŠ¤ìº”í•˜ê²Œ í•˜ì„¸ìš”.`)):l(``,!0),_.value?(t(),c(`div`,ue,[f(`div`,{id:`qrcode`,ref_key:`qrcodeContainer`,ref:E},null,512)])):l(``,!0),_.value&&e(U)?(t(),c(`a`,{key:3,href:e(U),target:`_blank`,class:`room-link`},r(e(U)),9,de)):l(``,!0),_.value&&v.value?(t(),c(`div`,fe,` ë‚´ ë£¸ ID: `+r(v.value),1)):l(``,!0),f(`div`,pe,[a[7]||=f(`svg`,{class:`spinner`,xmlns:`http://www.w3.org/2000/svg`,fill:`none`,viewBox:`0 0 24 24`},[f(`circle`,{class:`opacity-25`,cx:`12`,cy:`12`,r:`10`,stroke:`currentColor`,"stroke-width":`4`}),f(`path`,{class:`opacity-75`,fill:`currentColor`,d:`M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z`})],-1),f(`span`,me,r(S.value),1)]),st.value?(t(),c(`p`,he,r(st.value),1)):l(``,!0)],2),f(`div`,{id:`video-view`,class:u([`video-view`,{hidden:h.value!==`video`}])},[f(`div`,ge,[f(`header`,_e,[f(`span`,ve,r(_t.value),1),f(`div`,ye,[f(`button`,{id:`audio-volume-btn`,class:`audio-volume-btn`,onClick:Ot,title:`ì˜¤ë””ì˜¤ ë³¼ë¥¨ ì¡°ì ˆ`},[...a[8]||=[f(`svg`,{class:`w-6 h-6`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`},[f(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z`})],-1)]]),f(`button`,{id:`screen-share-btn`,class:`screen-share-btn`,onClick:a[1]||=e=>M.value?zt():Tt(),title:M.value?`ì¹´ë©”ë¼ë¡œ ì „í™˜`:`í™”ë©´ ê³µìœ `},[M.value?(t(),c(`svg`,Se,[...a[10]||=[f(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z`},null,-1)]])):(t(),c(`svg`,xe,[...a[9]||=[f(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z`},null,-1)]]))],8,be),f(`button`,{id:`options-btn`,class:`options-btn md:hidden`,onClick:Jt},[...a[11]||=[f(`svg`,{class:`w-6 h-6`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`},[f(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z`})],-1)]])])]),f(`div`,Ce,[f(`div`,we,[f(`video`,{ref_key:`remoteVideo`,ref:k,autoplay:``,playsinline:``,class:u([`remote-video`,{hidden:!j.value}])},null,2),j.value?l(``,!0):(t(),c(`div`,Te,[...a[12]||=[f(`svg`,{class:`w-24 h-24 text-gray-500`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`},[f(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z`})],-1),f(`p`,{class:`text-gray-400 mt-4`},`ìƒëŒ€ë°© ì—°ê²° ëŒ€ê¸° ì¤‘...`,-1)]]))]),f(`div`,Ee,[f(`video`,{ref_key:`localVideo`,ref:O,autoplay:``,playsinline:``,muted:``,class:u([`local-video`,{hidden:!A.value}])},null,2),M.value?(t(),c(`div`,De,[a[13]||=f(`svg`,{class:`w-4 h-4`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`},[f(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z`})],-1),a[14]||=f(`span`,null,`í™”ë©´ ê³µìœ  ì¤‘`,-1),F.value.length>0?(t(),c(`span`,Oe,`ğŸ”Š`)):l(``,!0),P.value?(t(),c(`span`,ke,`ğŸ“¹`)):l(``,!0)])):l(``,!0),A.value?l(``,!0):(t(),c(`div`,Ae,[...a[15]||=[f(`svg`,{class:`w-8 h-8 text-gray-500`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`},[f(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z`})],-1)]]))])]),f(`form`,{onSubmit:p(qt,[`prevent`]),class:`chat-form`},[i(f(`input`,{id:`message-input`,"onUpdate:modelValue":a[2]||=e=>g.value=e,type:`text`,placeholder:`ë©”ì‹œì§€ ì…ë ¥...`,autocomplete:`off`},null,512),[[re,g.value]]),a[16]||=f(`button`,{type:`submit`},[f(`svg`,{class:`w-6 h-6`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`},[f(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M12 19l9 2-9-18-9 18 9-2zm0 0v-8`})])],-1)],32)]),f(`div`,{id:`sidebar`,ref_key:`sidebar`,ref:ft,class:u([`sidebar`,{hidden:w.value}])},[f(`div`,je,[a[17]||=f(`h3`,null,`ì±„íŒ…`,-1),f(`div`,{id:`messages`,ref_key:`messagesContainer`,ref:T,class:`messages`},[(t(!0),c(o,null,ie(gt.value,(e,n)=>(t(),c(`div`,{key:n,class:u([`message-item`,{"message-right":e.senderId===v.value,"message-left":e.senderId!==v.value}])},[f(`div`,{class:u([`message-bubble`,{"bg-blue-600":e.senderId===v.value,"bg-gray-700":e.senderId!==v.value}])},[e.senderId===v.value?l(``,!0):(t(),c(`div`,Me,[m(r(e.displayName)+` `,1),f(`span`,Ne,`#`+r(e.shortId),1)])),f(`div`,Pe,r(e.text),1),f(`div`,Fe,r(Mt(e.timestamp)),1)],2)],2))),128))],512)]),f(`div`,Ie,[a[18]||=f(`h3`,null,`ì°¸ì—¬ QR ì½”ë“œ`,-1),f(`div`,Le,[f(`div`,{id:`qrcode-chat`,ref_key:`qrcodeChatContainer`,ref:D},null,512)]),vt.value?(t(),c(`a`,{key:0,href:vt.value,target:`_blank`,class:`sidebar-room-link`},r(vt.value),9,Re)):l(``,!0)]),f(`div`,ze,[a[19]||=f(`h3`,null,`ì°¸ì—¬ì`,-1),f(`ul`,Be,[f(`li`,Ve,[m(` ğŸ‘‘ `+r(e(G)||y.value)+` `,1),f(`span`,He,`#`+r(e(K)||b.value),1),(e(K)||b.value)===b.value?(t(),c(`span`,Ue,`(ë‚˜)`)):(t(),c(`span`,We,`(ë°©ì¥)`))]),(t(!0),c(o,null,ie(ht.value,e=>(t(),c(`li`,{key:e.id,class:u([`guest-item`,{"is-me":e.shortId===b.value}])},[f(`span`,null,[m(`ğŸ‘¤ `+r(e.name)+` `,1),f(`span`,Ge,`#`+r(e.shortId),1)]),e.shortId===b.value?(t(),c(`span`,Ke,`(ë‚˜)`)):l(``,!0)],2))),128))])])],2)],2),f(`div`,{id:`modal`,class:u([`modal-overlay`,{hidden:!ct.value}]),onClick:p(Ct,[`self`])},[f(`div`,qe,[f(`h3`,null,r(lt.value),1),f(`p`,null,r(ut.value),1),f(`div`,Je,[dt.value?(t(),c(o,{key:1},[f(`button`,{onClick:wt,class:`btn-modal-confirm`},`í™•ì¸`),f(`button`,{onClick:Ct,class:`btn-modal-cancel`},`ì·¨ì†Œ`)],64)):(t(),c(`button`,{key:0,onClick:Ct,class:`btn-modal-ok`},`í™•ì¸`))])])],2),f(`div`,{id:`screen-share-options-modal`,class:u([`modal-overlay`,{hidden:!pt.value}]),onClick:p(Et,[`self`])},[f(`div`,Ye,[a[22]||=f(`h3`,null,`í™”ë©´ ê³µìœ  ì˜µì…˜`,-1),f(`div`,Xe,[f(`label`,Ze,[i(f(`input`,{type:`checkbox`,"onUpdate:modelValue":a[3]||=e=>I.value.includeAudio=e},null,512),[[te,I.value.includeAudio]]),a[20]||=f(`span`,null,`ì˜¤ë””ì˜¤ë„ ê³µìœ í•˜ê¸°`,-1)]),f(`label`,Qe,[i(f(`input`,{type:`checkbox`,"onUpdate:modelValue":a[4]||=e=>I.value.keepCamera=e},null,512),[[te,I.value.keepCamera]]),a[21]||=f(`span`,null,`ì›¹ìº ë„ í•¨ê»˜ í‘œì‹œí•˜ê¸°`,-1)])]),f(`div`,{class:`modal-actions`},[f(`button`,{onClick:Dt,class:`btn-modal-confirm`},`ì‹œì‘`),f(`button`,{onClick:Et,class:`btn-modal-cancel`},`ì·¨ì†Œ`)])])],2),f(`div`,{id:`audio-volume-modal`,class:u([`modal-overlay`,{hidden:!mt.value}]),onClick:p(kt,[`self`])},[f(`div`,$e,[a[24]||=f(`h3`,null,`ì˜¤ë””ì˜¤ ë³¼ë¥¨ ì¡°ì ˆ`,-1),bt.value.length>0?(t(),c(`div`,et,[(t(!0),c(o,null,ie(bt.value,e=>(t(),c(`div`,{key:e.track.id,class:`audio-track-item`},[f(`div`,tt,[f(`span`,nt,r(e.label),1),f(`span`,rt,r(Math.round(e.volume*100))+`%`,1)]),f(`input`,{type:`range`,min:`0`,max:`1`,step:`0.01`,value:e.volume,onInput:t=>jt(e.track,parseFloat(t.target.value)),class:`volume-slider`},null,40,it)]))),128))])):(t(),c(`div`,at,[...a[23]||=[f(`p`,null,`í˜„ì¬ í™œì„±í™”ëœ ì˜¤ë””ì˜¤ íŠ¸ë™ì´ ì—†ìŠµë‹ˆë‹¤.`,-1)]])),f(`div`,{class:`modal-actions`},[f(`button`,{onClick:kt,class:`btn-modal-ok`},`ë‹«ê¸°`)])])],2)])],32))}},[[`__scopeId`,`data-v-be3b77f8`]]);export{h as default};