import{C as e,N as t,O as n,T as r,_ as i,b as a,d as o,f as s,g as c,h as l,j as u,k as d,l as f,m as p,p as m,s as h,u as g,v as _,w as v,x as ee,y}from"./index-DH5YoFRZ.js";import{t as b}from"./_plugin-vue_export-helper-9n1O4nl6.js";var x=[`title`],S={class:`todo-state-toggle-icon`,"aria-hidden":`true`},C={__name:`TodoStateToggle`,props:{state:{type:String,required:!0}},emits:[`change`],setup(n,{emit:r}){let i=[`not-started`,`in-progress`,`completed`],a={"not-started":`시작하지 않음`,"in-progress":`진행중`,completed:`완료`},o={"not-started":``,"in-progress":`~`,completed:`✓`},l=n,d=r,f=s(()=>o[l.state]??``),p=s(()=>a[l.state]??l.state),h=()=>{let e=i.indexOf(l.state),t=e<0?0:(e+1)%i.length;d(`change`,i[t])};return(r,i)=>(e(),c(`button`,{type:`button`,class:u([`todo-state-toggle`,`todo-state-${n.state}`]),title:p.value,"aria-label":`상태 변경`,onClick:g(h,[`stop`])},[m(`span`,S,t(f.value),1)],10,x))}},w=b(C,[[`__scopeId`,`data-v-728c9bcb`]]),T={class:`todo-item-content`},E=[`value`],D={__name:`TodoItem`,props:{todo:{type:Object,required:!0},collapsedSubtasks:{type:Set,required:!0}},emits:[`toggle-state`,`add-subtask`,`delete-todo`,`edit-text`,`toggle-collapse`,`drag-start`,`drag-end`,`drag-over`,`drag-leave`,`drop`],setup(n,{emit:i}){let a=n,s=i,f=d(!1),h=e=>{s(`toggle-state`,a.todo.id,e.target.value)},_=e=>{f.value=!0,s(`drag-start`,e,a.todo.id)},ee=e=>{f.value=!1,s(`drag-end`,e)},b=e=>{s(`drag-over`,e,a.todo.id)},x=e=>{s(`drag-leave`,e)},S=e=>{s(`drop`,e,a.todo.id)};return(i,a)=>{let d=r(`TodoItem`,!0);return e(),c(`li`,{class:u([n.todo.state,{dragging:f.value}]),draggable:!0,onDragstart:_,onDragend:ee,onDragover:g(b,[`prevent`]),onDragleave:x,onDrop:g(S,[`prevent`])},[m(`div`,T,[m(`div`,null,[n.todo.subtasks&&n.todo.subtasks.length>0?(e(),c(`button`,{key:0,class:u([`collapse-subtask-btn`,{collapsed:n.collapsedSubtasks.has(n.todo.id)}]),onClick:a[0]||=g(e=>i.$emit(`toggle-collapse`,n.todo.id),[`stop`]),title:`하위 할일 접기/펼치기`},` ▼ `,2)):l(``,!0),m(`label`,null,[y(w,{state:n.todo.state,onChange:a[1]||=e=>s(`toggle-state`,n.todo.id,e)},null,8,[`state`]),m(`span`,{class:`todo-text`,onClick:a[2]||=g(()=>{},[`stop`]),onDblclick:a[3]||=e=>i.$emit(`edit-text`,n.todo.id)},t(n.todo.text),33)])]),m(`div`,null,[m(`select`,{class:`todo-state`,value:n.todo.state,onChange:h},[...a[16]||=[m(`option`,{value:`not-started`},`시작하지 않음`,-1),m(`option`,{value:`in-progress`},`진행중`,-1),m(`option`,{value:`completed`},`완료`,-1)]],40,E),m(`button`,{class:`add-subtask-btn`,onClick:a[4]||=g(e=>i.$emit(`add-subtask`,n.todo.id),[`stop`]),title:`하위 할일 추가`},`+`),m(`button`,{class:`delete-todo-btn`,onClick:a[5]||=g(e=>i.$emit(`delete-todo`,n.todo.id),[`stop`]),title:`할일 삭제`},`×`)])]),n.todo.subtasks&&n.todo.subtasks.length>0?(e(),c(`ul`,{key:0,class:u([`subtask-list`,{collapsed:n.collapsedSubtasks.has(n.todo.id)}])},[(e(!0),c(o,null,v(n.todo.subtasks,t=>(e(),p(d,{key:t.id,todo:t,"collapsed-subtasks":n.collapsedSubtasks,onToggleState:a[6]||=(e,t)=>i.$emit(`toggle-state`,e,t),onAddSubtask:a[7]||=e=>i.$emit(`add-subtask`,e),onDeleteTodo:a[8]||=e=>i.$emit(`delete-todo`,e),onEditText:a[9]||=e=>i.$emit(`edit-text`,e),onToggleCollapse:a[10]||=e=>i.$emit(`toggle-collapse`,e),onDragStart:a[11]||=(e,t)=>i.$emit(`drag-start`,e,t),onDragEnd:a[12]||=e=>i.$emit(`drag-end`,e),onDragOver:a[13]||=(e,t)=>i.$emit(`drag-over`,e,t),onDragLeave:a[14]||=e=>i.$emit(`drag-leave`,e),onDrop:a[15]||=(e,t)=>i.$emit(`drop`,e,t)},null,8,[`todo`,`collapsed-subtasks`]))),128))],2)):l(``,!0)],34)}}},te=b(D,[[`__scopeId`,`data-v-3ed79701`]]),ne={class:`todo-app`},re={class:`container`},ie={id:`tabsContainer`,class:`tabs-container`},ae=[`onDragstart`,`onDragover`,`onDragleave`,`onDrop`,`onClick`],oe=[`onDblclick`],se=[`onClick`],ce={class:`controls-container`},le={key:0,id:`todoList`},ue={key:1,class:`empty-list-message`},de={class:`dialog-actions`},fe=`ABCI_TodoList_Tabs`,pe=2,O=`todos`,k=`tabs`,me=`  `,A=b({__name:`index`,setup(r){let y=d(null),b=d([]),x=d(null),S=d([]),C=d(new Set),w=d(``),T=d(`임시 할일 리스트`),E=d(null),D=d(null),A=d(null),j=d(null),M=d(null),N=d(null),P=d(null),F=d(``),I=d(``),he=d(``),ge=d(``),L=d(`alert`),R=d(``),z=d(null),_e=d(!1),ve=d(!1),ye=d(`확인`),be=d(`취소`),B=d(null),V=d(null),xe=s(()=>[...S.value].sort((e,t)=>(e.order||0)-(t.order||0))),Se=s(()=>{if(!w.value)return b.value;let e=w.value.toLowerCase(),t=b.value.filter(t=>t.text.toLowerCase().includes(e)),n=new Set;return t.forEach(e=>{let t=e;for(;t;)n.add(t.id),t=b.value.find(e=>e.id===t.parentId)}),b.value.filter(e=>n.has(e.id))}),Ce=s(()=>we(Se.value));function we(e){let t=new Map(e.map(e=>[e.id,{...e,subtasks:[]}])),n=[];for(let e of t.values())e.parentId&&t.has(e.parentId)?t.get(e.parentId).subtasks.push(e):n.push(e);let r=e=>e.sort((e,t)=>(e.order||0)-(t.order||0));for(let e of t.values())e.subtasks.length>0&&r(e.subtasks);return r(n),n}let Te=()=>new Promise((e,t)=>{let n=indexedDB.open(fe,pe);n.onupgradeneeded=e=>{let t=e.target.result;t.objectStoreNames.contains(O)||t.createObjectStore(O,{keyPath:`id`}).createIndex(`tabId`,`tabId`,{unique:!1}),t.objectStoreNames.contains(k)||t.createObjectStore(k,{keyPath:`id`})},n.onsuccess=t=>{y.value=t.target.result,e(y.value)},n.onerror=e=>t(e.target.errorCode)}),H=e=>new Promise(t=>{y.value.transaction(e).objectStore(e).getAll().onsuccess=e=>t(e.target.result)}),Ee=e=>new Promise(t=>{y.value.transaction(O).objectStore(O).index(`tabId`).getAll(e).onsuccess=e=>t(e.target.result)}),U=(e,t)=>{let n=JSON.parse(JSON.stringify(t));return new Promise(t=>{y.value.transaction(e,`readwrite`).objectStore(e).put(n).onsuccess=t})},W=e=>new Promise(t=>{he.value=e.title,ge.value=e.message,L.value=e.type||`alert`,R.value=e.defaultValue||``,z.value=t,ye.value=e.okText||`확인`,be.value=e.cancelText||`취소`,_e.value=!0,ve.value=e.type===`confirm`||e.type===`prompt`,A.value&&(A.value.showModal(),a(()=>{e.type===`prompt`&&N.value?N.value.focus():P.value&&P.value.focus()}))}),De=()=>{A.value&&A.value.close();let e=L.value===`prompt`?R.value:!0;z.value&&=(z.value(e),null)},Oe=()=>{A.value&&A.value.close();let e=L.value===`prompt`?null:!1;z.value&&=(z.value(e),null)},G=(e,t=`알림`)=>W({title:t,message:e,type:`alert`}),K=(e,t=`확인`)=>W({title:t,message:e,type:`confirm`}),q=(e,t,n=`입력`)=>W({title:n,message:e,defaultValue:t,type:`prompt`}),J=async()=>{let e=await H(k),t=[];if(e.forEach((e,n)=>{e.order===void 0&&(e.order=n,t.push(e))}),t.length>0){let e=y.value.transaction(k,`readwrite`);t.forEach(t=>e.objectStore(k).put(t)),await new Promise(t=>e.oncomplete=t)}S.value=e},ke=async()=>{let e=await q(`새 탭의 이름을 입력하세요:`,`새 목록`);if(e&&e.trim()){let t=await H(k),n=e.trim();if(t.find(e=>e.name===n)){await G(`'${n}' 이름의 탭이 이미 존재합니다. 다른 이름을 사용해주세요.`,`중복된 탭 이름`);return}let r=t.length,i={id:`tab-${Date.now()}`,name:n,order:r};await U(k,i),await Y(i.id)}},Ae=async e=>{let t=await q(`탭의 새 이름을 입력하세요:`,e.name);if(t&&t.trim()&&t.trim()!==e.name){let n=t.trim();if((await H(k)).find(t=>t.name===n&&t.id!==e.id)){await G(`'${n}' 이름의 탭이 이미 존재합니다. 다른 이름을 사용해주세요.`,`중복된 탭 이름`);return}let r={id:e.id,name:n,order:e.order??0};await U(k,r),S.value=await H(k)}},je=async e=>{if(!await K(`이 탭과 모든 할 일을 삭제하시겠습니까? 이 작업은 되돌릴 수 없습니다.`))return;let t=y.value.transaction([O,k],`readwrite`),n=t.objectStore(O),r=t.objectStore(k),i=n.index(`tabId`).openCursor(e);i.onsuccess=e=>{let t=e.target.result;t&&(t.delete(),t.continue())},r.delete(e),t.oncomplete=async()=>{if(x.value===e){let e=await H(k),t=e.length>0?e[0].id:null;await Y(t)}else await J()}},Y=async e=>{x.value=e,localStorage.setItem(`currentTabId`,e),await J(),await X()},Me=(e,t)=>{B.value=t,e.dataTransfer.effectAllowed=`move`,e.dataTransfer.setData(`text/plain`,t),e.target.classList.add(`dragging`)},Ne=e=>{e.target.classList.remove(`dragging`),document.querySelectorAll(`.drag-over`).forEach(e=>e.classList.remove(`drag-over`)),B.value=null},Pe=(e,t)=>{t!==B.value&&(document.querySelectorAll(`.drag-over`).forEach(e=>e.classList.remove(`drag-over`)),e.target.closest(`.tab-item`)?.classList.add(`drag-over`))},Fe=(e,t)=>{e.target.closest(`.tab-item`)?.classList.remove(`drag-over`)},Ie=async(e,t)=>{e.preventDefault(),document.querySelectorAll(`.drag-over`).forEach(e=>e.classList.remove(`drag-over`));let n=B.value;!t||n===t||await Le(n,t)},Le=async(e,t)=>{let n=(await H(k)).sort((e,t)=>(e.order||0)-(t.order||0)),r=n.findIndex(t=>t.id===e),i=n.findIndex(e=>e.id===t);if(r===-1||i===-1)return;let[a]=n.splice(r,1);n.splice(i,0,a);let o=[];n.forEach((e,t)=>{e.order!==t&&(e.order=t,o.push(U(k,e)))}),o.length>0&&(await Promise.all(o),await J())},X=async()=>{if(!x.value){b.value=[];return}let e=await Ee(x.value),t=[],n=new Map;if(e.forEach(e=>{let t=e.parentId||null;n.has(t)||n.set(t,[]),n.get(t).push(e)}),n.forEach(e=>{e.forEach((e,n)=>{e.order===void 0&&(e.order=n,t.push(e))})}),t.length>0){let n=y.value.transaction(O,`readwrite`);t.forEach(e=>n.objectStore(O).put(e)),await new Promise(e=>n.oncomplete=e),e=await Ee(x.value)}b.value=e},Re=async e=>{let t=await q(`새 하위 할일의 내용을 입력하세요:`,``);if(t&&t.trim()){let n=b.value.filter(t=>t.parentId===e),r={id:`todo-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,text:t.trim(),state:`not-started`,parentId:e,tabId:x.value,order:n.length};await U(O,r);let i=b.value.find(t=>t.id===e);i&&i.state===`completed`&&(i.state=`in-progress`,await U(O,i),await Z(i.parentId)),await X()}},ze=async e=>{if(!await K(`이 할 일과 모든 하위 할 일을 삭제하시겠습니까?`))return;let t=new Set([e]),n=e=>{b.value.filter(t=>t.parentId===e).forEach(e=>{t.add(e.id),n(e.id)})};n(e);let r=y.value.transaction(O,`readwrite`),i=r.objectStore(O);t.forEach(e=>i.delete(e)),r.oncomplete=async()=>{await X()}},Be=async e=>{let t=b.value.find(t=>t.id===e);if(!t)return;let n=await q(`할일 내용을 수정하세요:`,t.text,`할일 수정`);n&&n.trim()&&n.trim()!==t.text&&(t.text=n.trim(),await U(O,t),await X())},Ve=e=>{C.value.has(e)?C.value.delete(e):C.value.add(e)},He=async(e,t)=>{let n=b.value.find(t=>t.id===e);n&&n.state!==t&&(n.state=t,await U(O,n),await Z(n.parentId),t===`completed`&&await Ue(e,`completed`),await X())},Z=async e=>{if(!e)return;let t=b.value.find(t=>t.id===e),n=b.value.filter(t=>t.parentId===e);if(t&&n.length>0){let e=n.every(e=>e.state===`completed`),r=n.some(e=>e.state===`in-progress`),i=e?`completed`:r||n.some(e=>e.state===`completed`)?`in-progress`:`not-started`;t.state!==i&&(t.state=i,await U(O,t),await Z(t.parentId))}},Ue=async(e,t)=>{let n=b.value.filter(t=>t.parentId===e);for(let e of n)e.state!==t&&(e.state=t,await U(O,e),await Ue(e.id,t))},We=async()=>{if(!x.value||b.value.length===0){await G(`초기화할 할일이 없습니다.`);return}if(!await K(`현재 탭의 모든 할일을 "시작하지 않음" 상태로 변경하시겠습니까?`))return;let e=[];b.value.forEach(t=>{t.state!==`not-started`&&(t.state=`not-started`,e.push(U(O,t)))}),e.length>0?(await Promise.all(e),await X(),await G(`${e.length}개의 할일이 초기화되었습니다.`)):await G(`이미 모든 할일이 "시작하지 않음" 상태입니다.`)},Ge=async()=>{if(!x.value||b.value.length===0){await G(`삭제할 완료된 할일이 없습니다.`);return}let e=b.value.filter(e=>e.state===`completed`);if(e.length===0){await G(`완료된 할일이 없습니다.`);return}if(!await K(`완료된 ${e.length}개의 할일을 삭제하시겠습니까? 이 작업은 되돌릴 수 없습니다.`))return;let t=y.value.transaction(O,`readwrite`),n=t.objectStore(O);e.forEach(e=>n.delete(e.id)),t.oncomplete=async()=>{await X(),await G(`${e.length}개의 완료된 할일이 삭제되었습니다.`)}},Ke=e=>e===`completed`?`[x]`:e===`in-progress`?`[o]`:`[ ]`,qe=e=>{if(!e||e.length===0)return``;let t=we(e),n=``,r=(e,t=0)=>{let i=`  `.repeat(t),a=Ke(e.state);n+=i+`- `+a+` `+e.text+`
`,e.subtasks&&e.subtasks.length>0&&e.subtasks.forEach(e=>{r(e,t+1)})};return t.forEach(e=>r(e)),n.trim()},Je=async()=>{if(!x.value){await G(`먼저 탭을 선택해주세요.`);return}if(b.value.length===0){await G(`내보낼 할일이 없습니다.`);return}I.value=qe(b.value),D.value&&D.value.showModal()},Ye=async()=>{try{await navigator.clipboard.writeText(I.value),await G(`할일 목록이 클립보드에 복사되었습니다.`)}catch(e){console.error(`클립보드 복사 실패:`,e),M.value&&(M.value.select(),document.execCommand(`copy`)),await G(`할일 목록이 클립보드에 복사되었습니다.`)}},Xe=async()=>{if(!x.value){await G(`먼저 탭을 선택해주세요.`);return}let e=Qe(I.value,x.value);if(e.length===0){await G(`적용할 항목이 없습니다. 마크다운 형식(- [ ] / - [o] / - [x] + 내용)을 확인해주세요.`);return}let t=y.value.transaction(O,`readwrite`),n=t.objectStore(O);b.value.map(e=>e.id).forEach(e=>n.delete(e)),e.forEach(e=>n.put(e)),await new Promise(e=>t.oncomplete=e),await X(),Q(),await G(`편집 내용 ${e.length}개 항목으로 적용되었습니다.`)},Ze=e=>{let t=e.match(/^\s*-\s*\[\s*([ xo])\]\s*(.*)$/i);if(t){let n=t[1].toLowerCase(),r=n===`x`?`completed`:n===`o`?`in-progress`:`not-started`,i=t[2].trim();return{indent:e.match(/^\s*/)[0].length,state:r,text:i}}let n=e.match(/^\s*((?:[-*+]|\d+\.)\s+)(.*)$/);if(n){let t=e.match(/^\s*/)[0].length,r=n[2].trim();return{indent:t,state:`not-started`,text:r}}return null},Qe=(e,t)=>{let n=e.split(`
`),r=[],i=[],a=new Map;return n.forEach(e=>{let n=Ze(e);if(!n||!n.text)return;let{indent:o,state:s,text:c}=n,l=`todo-${Date.now()}-${Math.random().toString(36).substring(2,9)}`;for(;i.length>0&&i[i.length-1].indent>=o;)i.pop();let u=i.length>0?i[i.length-1].id:null,d=a.get(u)||0;r.push({id:l,text:c,state:s,parentId:u,tabId:t,order:d}),a.set(u,d+1),i.push({id:l,indent:o})}),r},$e=async()=>{if(!x.value){await G(`먼저 탭을 선택하거나 생성해주세요.`);return}let e=F.value,t=Qe(e,x.value);if(t.length>0){let e=y.value.transaction(O,`readwrite`);t.forEach(t=>e.objectStore(O).put(t)),await new Promise(t=>e.oncomplete=t),F.value=``,tt(),await X()}},et=()=>{E.value&&(E.value.showModal(),a(()=>{j.value&&j.value.focus()}))},tt=()=>{E.value&&E.value.close()},Q=()=>{D.value&&D.value.close()},nt=(e,t)=>t<=0?0:(e.slice(0,t).match(/\n/g)||[]).length,$=(e,t)=>{let n=e.split(`
`);if(t<=0)return 0;let r=0;for(let e=0;e<t&&e<n.length;e++)r+=n[e].length+1;return r},rt=e=>{let t=M.value;if(!t)return;if(e.key===`Escape`){e.preventDefault(),Q();return}if((e.ctrlKey||e.metaKey)&&e.key===`Enter`){e.preventDefault(),Xe();return}let n=I.value,r=n.split(`
`),i=t.selectionStart,o=t.selectionEnd,s=nt(n,i),c=nt(n,o>0?o-1:0),l=c-s+1;if(e.key===`Tab`){if(e.preventDefault(),r.length===0)return;let t=$(n,s),i=$(n,c+1),o=r.slice(s,c+1),l=(e.shiftKey?o.map(e=>e.startsWith(me)?e.substring(2):e):o.map(e=>me+e)).join(`
`),u=n.substring(0,t)+l+n.substring(i);I.value=u,a(()=>{M.value&&(M.value.selectionStart=$(u,s),M.value.selectionEnd=$(u,c+1),M.value.focus())});return}if(e.ctrlKey&&e.shiftKey&&e.key===`K`||e.ctrlKey&&e.key===`D`){if(e.preventDefault(),r.length===0)return;r.splice(s,l);let t=r.join(`
`);I.value=t,a(()=>{if(!M.value)return;let e=Math.min(s,r.length-1),n=e>=0?$(t,e):0;M.value.selectionStart=n,M.value.selectionEnd=n,M.value.focus()});return}if(!e.altKey||e.key!==`ArrowUp`&&e.key!==`ArrowDown`||(e.preventDefault(),r.length===0))return;if(e.key===`ArrowUp`){if(s===0)return;let e=r.splice(s,l);r.splice(s-1,0,...e)}else{if(c>=r.length-1)return;let e=r.splice(s,l);r.splice(s+1,0,...e)}let u=r.join(`
`);I.value=u,a(()=>{if(!M.value)return;let t=e.key===`ArrowUp`?s-1:s+1,n=t+l-1;M.value.selectionStart=$(u,t),M.value.selectionEnd=$(u,n+1),M.value.focus()})},it=e=>{if(e.key===`Tab`){e.preventDefault();let t=e.target,n=t.selectionStart,r=t.selectionEnd,i=t.value,a=n;for(;a>0&&i[a-1]!==`
`;)a--;let o=r;for(r>n&&i[r-1]===`
`&&(o=r-1);o<i.length&&i[o]!==`
`;)o++;let s=i.substring(a,o),c=s.split(`
`),l;if(e.shiftKey){l=c.map(e=>e.startsWith(`  `)?e.substring(2):e).join(`
`),t.value=i.substring(0,a)+l+i.substring(o);let e=c[0].startsWith(`  `)?2:0;t.selectionStart=Math.max(a,n-e),t.selectionEnd=r+(l.length-s.length)}else{let e=c.map(e=>`  `+e);l=e.join(`
`),t.value=i.substring(0,a)+l+i.substring(o),t.selectionStart=n+2,t.selectionEnd=r+e.length*2}}(e.ctrlKey||e.metaKey)&&e.key===`Enter`&&(e.preventDefault(),$e())},at=(e,t)=>{V.value=t,e.dataTransfer.effectAllowed=`move`,e.dataTransfer.setData(`text/plain`,t)},ot=e=>{e.target.closest(`li`)?.classList.remove(`dragging`),document.querySelectorAll(`.drag-over`).forEach(e=>e.classList.remove(`drag-over`)),V.value=null},st=(e,t)=>{t!==V.value&&(document.querySelectorAll(`.drag-over`).forEach(e=>e.classList.remove(`drag-over`)),e.target.closest(`li`)?.classList.add(`drag-over`))},ct=e=>{e.target.closest(`li`)?.classList.remove(`drag-over`)},lt=async(e,t)=>{e.preventDefault(),document.querySelectorAll(`.drag-over`).forEach(e=>e.classList.remove(`drag-over`));let n=V.value;!t||n===t||await ut(n,t)},ut=async(e,t)=>{let n=b.value.find(t=>t.id===e),r=b.value.find(e=>e.id===t);if(!n||!r)return;let i=n.parentId??null,a=r.parentId??null;if(i===a){let n=b.value.filter(e=>(e.parentId??null)===i).sort((e,t)=>(e.order||0)-(t.order||0)),r=n.findIndex(t=>t.id===e),a=n.findIndex(e=>e.id===t);if(r===-1||a===-1)return;let[o]=n.splice(r,1);n.splice(a,0,o);let s=[];n.forEach((e,t)=>{e.order!==t&&(e.order=t,s.push(U(O,e)))}),s.length>0&&(await Promise.all(s),await X())}else await dt(e,t)},dt=async(e,t)=>{let n=b.value.find(t=>t.id===e),r=b.value.find(e=>e.id===t);if(!n||!r||e===t)return;let i=(e,t)=>{let n=b.value.filter(t=>t.parentId===e);for(let e of n)if(e.id===t||i(e.id,t))return!0;return!1};if(i(e,t)){await G(`하위 할일을 상위 할일로 만들 수 없습니다.`);return}let a=n.text.length>30?n.text.substring(0,30)+`...`:n.text,o=r.text.length>30?r.text.substring(0,30)+`...`:r.text,s=`"${a}"을(를) "${o}"의 하위 할일로 만들겠습니까?`;if(!await K(s,`계층 구조 변경`))return;let c=n.parentId,l=b.value.filter(e=>e.parentId===c);n.parentId=t,n.order=b.value.filter(e=>e.parentId===t).length;let u=[U(O,n)];l.forEach((e,t)=>{e.order!==t&&(e.order=t,u.push(U(O,e)))}),await Promise.all(u),await X()},ft=async()=>{let e=T.value,t=await q(`새 제목을 입력하세요:`,e,`제목 편집`);t&&t.trim()&&t.trim()!==e&&(T.value=t.trim(),document.title=t.trim(),localStorage.setItem(`todoAppTitle`,t.trim()))},pt=async()=>{try{let e=localStorage.getItem(`todoAppTitle`);e&&(T.value=e,document.title=e),await Te();let t=await H(k);if(t.length===0){let e={id:`tab-${Date.now()}`,name:`기본 목록`,order:0};await U(k,e),t.push(e)}let n=localStorage.getItem(`currentTabId`);(!n||!t.some(e=>e.id===n))&&(n=t[0].id),await Y(n)}catch(e){console.error(`Failed to initialize app:`,e)}};return ee(()=>{pt()}),(r,a)=>(e(),c(`div`,ne,[m(`div`,re,[m(`h1`,{onDblclick:ft,id:`mainTitle`},t(T.value),33),m(`div`,ie,[(e(!0),c(o,null,v(xe.value,n=>(e(),c(`div`,{key:n.id,class:u([`tab-item`,{active:n.id===x.value}]),draggable:!0,onDragstart:e=>Me(e,n.id),onDragend:Ne,onDragover:g(e=>Pe(e,n.id),[`prevent`]),onDragleave:e=>Fe(e,n.id),onDrop:g(e=>Ie(e,n.id),[`prevent`]),onClick:e=>Y(n.id)},[m(`span`,{onDblclick:g(e=>Ae(n),[`stop`])},t(n.name),41,oe),m(`button`,{class:`delete-tab-btn`,onClick:g(e=>je(n.id),[`stop`])},`×`,8,se)],42,ae))),128)),m(`button`,{id:`addTabBtn`,onClick:ke},`+`)]),m(`div`,ce,[m(`button`,{onClick:et},`할 일 추가`),m(`button`,{onClick:Je},`할일 목록 수정 및 내보내기`),m(`button`,{onClick:We},`모두 시작전으로`),m(`button`,{onClick:Ge},`완료항목 삭제`),n(m(`input`,{type:`text`,"onUpdate:modelValue":a[0]||=e=>w.value=e,placeholder:`할일 검색...`,"aria-label":`할일 검색`},null,512),[[h,w.value]])]),Se.value.length>0?(e(),c(`ul`,le,[(e(!0),c(o,null,v(Ce.value,t=>(e(),p(te,{key:t.id,todo:t,"collapsed-subtasks":C.value,onToggleState:He,onAddSubtask:Re,onDeleteTodo:ze,onEditText:Be,onToggleCollapse:Ve,onDragStart:at,onDragEnd:ot,onDragOver:st,onDragLeave:ct,onDrop:lt},null,8,[`todo`,`collapsed-subtasks`]))),128))])):(e(),c(`div`,ue,[w.value?(e(),c(o,{key:0},[_(` '`+t(w.value)+`'에 대한 검색 결과가 없습니다. `,1)],64)):x.value?(e(),c(o,{key:1},[a[4]||=_(` 할일 목록이 없습니다.`,-1),a[5]||=m(`br`,null,null,-1),a[6]||=_(`'할 일 추가' 버튼으로 목록을추가하세요. `,-1)],64)):(e(),c(o,{key:2},[_(` 탭을 선택하거나 '+' 버튼을 눌러 새 탭을 만드세요. `)],64))]))]),m(`dialog`,{ref_key:`markdownModal`,ref:E,class:`modal`},[a[7]||=m(`h2`,null,`새 할 일 추가`,-1),n(m(`textarea`,{ref_key:`modalMarkdownInput`,ref:j,"onUpdate:modelValue":a[1]||=e=>F.value=e,placeholder:`여기에 할일 목록을 마크다운 형식으로 입력하세요.
들여쓰기를 사용하여 하위 작업을 만들 수 있습니다.`,onKeydown:it},null,544),[[h,F.value]]),m(`div`,{class:`dialog-actions`},[m(`button`,{onClick:$e,id:`confirmLoadBtn`},`불러오기`),m(`button`,{onClick:tt,id:`closeModalBtn`},`취소`)])],512),m(`dialog`,{ref_key:`exportModal`,ref:D,class:`modal`},[a[8]||=i(`<h2 data-v-ede89056>할일 목록 수정 및 내보내기</h2><p data-v-ede89056>진행상황 포함 마크다운: <code data-v-ede89056>- [ ]</code> 시작전, <code data-v-ede89056>- [o]</code> 진행중, <code data-v-ede89056>- [x]</code> 완료. 내용을 수정한 뒤 적용할 수 있습니다.</p><p class="export-textarea-hint" title="Ctrl+Enter: 편집 내용 적용 · Esc: 닫기 · Tab/Shift+Tab: 들여쓰기 · Alt+↑/↓: 줄 이동 · Ctrl+Shift+K/Ctrl+D: 줄 삭제" data-v-ede89056><mark data-v-ede89056>Ctrl</mark>+<mark data-v-ede89056>Enter</mark>: 적용 · <mark data-v-ede89056>Esc</mark>: 닫기 · <mark data-v-ede89056>Tab</mark> / <mark data-v-ede89056>Shift</mark>+<mark data-v-ede89056>Tab</mark>: 들여쓰기 · <mark data-v-ede89056>Alt</mark>+<mark data-v-ede89056>↑</mark> / <mark data-v-ede89056>Alt</mark>+<mark data-v-ede89056>↓</mark>: 줄 이동 · <mark data-v-ede89056>Ctrl</mark>+<mark data-v-ede89056>Shift</mark>+<mark data-v-ede89056>K</mark> / <mark data-v-ede89056>Ctrl</mark>+<mark data-v-ede89056>D</mark>: 줄 삭제 </p>`,3),n(m(`textarea`,{ref_key:`exportTextarea`,ref:M,"onUpdate:modelValue":a[2]||=e=>I.value=e,placeholder:`내보낼 할일 목록이 여기에 표시됩니다.`,title:`Ctrl+Enter: 편집 내용 적용 · Esc: 닫기 · Tab/Shift+Tab: 들여쓰기 · Alt+↑/↓: 줄 이동 · Ctrl+Shift+K/Ctrl+D: 줄 삭제`,onKeydown:rt},null,544),[[h,I.value]]),m(`div`,{class:`dialog-actions`},[m(`button`,{onClick:Xe,class:`apply-export-btn`},`편집 내용 적용`),m(`button`,{onClick:Ye},`클립보드에 복사`),m(`button`,{onClick:Q},`닫기`)])],512),m(`dialog`,{ref_key:`customModal`,ref:A,class:`modal`},[m(`h3`,null,t(he.value),1),m(`p`,null,t(ge.value),1),L.value===`prompt`?n((e(),c(`input`,{key:0,type:`text`,ref_key:`customModalInput`,ref:N,"onUpdate:modelValue":a[3]||=e=>R.value=e,onKeydown:f(De,[`enter`])},null,544)),[[h,R.value]]):l(``,!0),m(`div`,de,[_e.value?(e(),c(`button`,{key:0,ref_key:`customModalOkBtn`,ref:P,class:`custom-modal-ok`,onClick:De},t(ye.value),513)):l(``,!0),ve.value?(e(),c(`button`,{key:1,class:`custom-modal-cancel`,onClick:Oe},t(be.value),1)):l(``,!0)])],512)]))}},[[`__scopeId`,`data-v-ede89056`]]);export{A as default};