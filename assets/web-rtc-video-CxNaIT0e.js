import{A as e,C as t,D as n,M as r,O as i,S as a,T as o,_ as ee,b as te,c as ne,d as s,f as c,h as l,k as u,l as d,m as f,o as re,r as ie,u as p,x as ae,y as oe}from"./index-CxO5bnR4.js";import{t as se}from"./_plugin-vue_export-helper-9n1O4nl6.js";var ce={class:`main-container`},le={key:0},ue={key:1},de={key:2,id:`qrcode-container`,class:`qrcode-container`},fe=[`href`],pe={key:4,class:`room-id-display`},me={class:`status-container`},he={id:`status-text`},ge={key:5,class:`witty-message`},_e={class:`video-main`},ve={class:`video-header`},ye={class:`video-header-title`},be={class:`video-header-actions`},xe=[`title`],Se={key:0,class:`w-6 h-6`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`},Ce={key:1,class:`w-6 h-6`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`},we={class:`video-container`},Te={class:`remote-video-wrapper`},Ee={key:0,class:`video-placeholder`},De={class:`local-video-wrapper`},Oe={key:0,class:`screen-share-badge`},ke={key:0,class:`audio-indicator`},Ae={key:1,class:`camera-indicator`},je={key:1,class:`video-placeholder-small`},Me={class:`sidebar-section`},Ne={key:0,class:`message-name`},Pe={class:`text-xs text-gray-400`},Fe={class:`message-text`},Ie={class:`message-time`},Le={class:`sidebar-section`},Re={id:`qrcode-chat-container`,class:`qrcode-chat-container`},ze=[`href`],Be={class:`sidebar-section`},Ve={id:`guest-list`,class:`guest-list`},He={class:`guest-item host`},Ue={class:`text-xs text-gray-400`},We={key:0},Ge={key:1},Ke={class:`text-xs text-gray-400`},qe={key:0},Je={class:`modal-content`},Ye={class:`modal-actions`},Xe={class:`modal-content`},Ze={class:`screen-share-options`},Qe={class:`option-checkbox`},$e={class:`option-checkbox`},et={class:`modal-content audio-volume-modal-content`},tt={key:0,class:`audio-tracks-list`},nt={class:`audio-track-label`},rt={class:`track-name`},it={class:`track-volume`},at=[`value`,`onInput`],ot={key:1,class:`no-audio-tracks`},m=se({__name:`index`,setup(se){let m=i(`home`),st=i(``),h=i(``),g=i(!1),_=i(null),v=i(null),y=i(null),b=i(null),x=i(``),ct=i(``),lt=i(!1),ut=i(``),dt=i(``),ft=i(!1),S=i(null),C=i(!0),w=i(null),pt=i(null),T=i(null),E=i(null),D=i(null),O=i(null),k=i(null),A=i(null),j=i(!1),M=i(null),N=i(null),P=i([]),mt=i(!1),F=i({includeAudio:!1,keepCamera:!1}),ht=i(!1),I=new Map,L=i(null),R=null,z=new Map,B=new Map,V=new Map,H=i(null),U=null,W=i(null),G=i(null),K=i([]),q=null,J=null,Y=null,X=`ì˜ì—­ ì „ê°œ ì¤‘...(ì£¼ìˆ ì „ë¬¸ê³  í•™ìƒë“¤ì˜ ì‘ì›ì„ ë°›ëŠ” ì¤‘...(ì´íƒ€ë„ë¦¬ ìœ ì§€ê°€ ì£¼ë¬¼ì„ ì‚¼í‚¤ëŠ” ì¤‘...(ì˜·ì½”ì¸  ìœ íƒ€ê°€ ë¦¬ì¹´ì˜ ì €ì£¼ë¥¼ í‘¸ëŠ” ì¤‘...(ì „ì§‘ì¤‘ í˜¸í¡ ìµíˆëŠ” ì¤‘...(ë¹ˆí‹ˆì˜ ì‹¤ì„ ì°¾ëŠ” ì¤‘...(é›·ì˜ å‘¼å¸, å£±ãƒå‹, éœ¹é‚ä¸€é–ƒ!(ë”ìš± ë” ê·¸ ë„˜ì–´ë¡œ! Plus Ultra!(ê³ ë¬´ê³ ë¬´! ë¹ ë¥´ê²Œ ê¸°ë‹¤ë¦¬ê¸°!(ì œí•˜í•˜í•˜!!! ì´ ë¡œë”© ì†ë„ëŠ” ë­ëƒ!!!(ì¡°ë¡œê°€ ë¹ ë¥´ê²Œ ê¸¸ì„ ì°¾ê³  ìˆëŠ” ì¤‘...(ìˆ˜ë‘”! ê¸°ë‹¤ë¦¬ê¸°ì˜ ìˆ !(ì¸í„°ë„·ì´ ì—†ëŠ” ê³³ì—ì„œ ì´ ì •ë„ì˜ ë°ì´í„°ëŸ‰ì´ë¼ë‹ˆ í¬í‘!!(ì±„íŒ…ì›Œë“œ...ì˜¤...ë¹ ...(íƒ€ì½”í”¼ê°€ ë‹¹ì‹ ì„ í•´í”¼í•˜ê²Œ ë§Œë“¤ ë°©ë²•ì„ ê³ ë¯¼í•˜ëŠ” ì¤‘...(ì‹œì¦ˆì¹´ì˜ ë¯¸ì†Œë¥¼ ë³´ê¸° ìœ„í•´, ì‚¬ì§„ì„ ì°ëŠ” ì¤‘...(íƒ€ì½”í”¼ê°€ ì¹œêµ¬ì™€ í™”í•´í•˜ê¸°ë¥¼ ë°”ë¼ë©° ë¦¬ë³¸ì„ ì°¾ëŠ” ì¤‘...(ì•„ë§ˆë¯¸ì•¼ ì†Œë¼ê°€ ì‰ì—¬ì—¬ì‹  ì—°ê¸°ë¥¼ ì¤€ë¹„í•˜ëŠ” ì¤‘...(ì´ì¹˜íˆë©”ê°€ í™”ë£Œ ì§ì „ ë”°ë´‰ì„ ì¤€ë¹„í•˜ëŠ” ì¤‘...(ë„ëŒ€ì²´ ì–¸ì œë¶€í„° ì„œë²„ê°€ í„°ì¡Œë‹¤ê³  ìƒê°í•œ ê±°ì§€?(íŠ¸ë˜í”½ì„, íŠ¸ë˜í”½ì„ ë†’ì´ì§€ ë§ˆë¼(ë” ê³µì—°ì„ ì¶•í•˜í•˜ê¸° ìœ„í•´ í˜„ê´€ ì•ì—ì„œ ê½ƒ ë“¤ê³  ëŒ€ê¸° ì¤‘...(ë¦¬ì¹˜ ì¼ë°œ ë„ë¼3 ë’·ë„ë¼ 3 í˜¼ì¼ìƒ‰ ì‚°ì•ˆì»¤ << ì§„ì§œ ì‚¬ê¸°ì¹˜ë„¤ ã…‹ã…‹(ì™œ ë§ˆì‘ë¶€ì¥ì´ ë‹¤ìŒ ì‹¬í™” ê°•ì˜ë¥¼ ì°ëŠ” ì¤‘...(íšŒì¥ì´ ì¢…ì‹  ì„ ì–¸ë¬¸ì„ ì‘ì„±í•˜ëŠ” ì¤‘...(ëŒ€í•™ì›ìƒì´ ì—°êµ¬ì‹¤ì—ì„œ ë¹¨ë¦¬ ë‚˜ê°€ê¸°ë¥¼ ë°”ë¼ë©° ëŒ€ê¸° ì¤‘...`.split(`(`),gt=s(()=>Array.from(B.entries()).map(([e,{name:t,shortId:n}])=>({id:e,name:t,shortId:n}))),_t=s(()=>[...K.value].sort((e,t)=>new Date(e.timestamp)-new Date(t.timestamp))),vt=s(()=>g.value?`${v.value}ë‹˜ì˜ í™”ìƒí†µí™”`:W.value?`${W.value}ë‹˜ì˜ í™”ìƒí†µí™”`:`í˜¸ìŠ¤íŠ¸ ì •ë³´ ê¸°ë‹¤ë¦¬ëŠ” ì¤‘...`),yt=s(()=>g.value?H.value:H.value||(b.value?`${window.location.origin}${window.location.pathname}#${b.value}`:``)),Z=i(new Map),bt=s(()=>{if(!k.value)return[];let e=[];return k.value.getAudioTracks().forEach(t=>{let n=`ì˜¤ë””ì˜¤ íŠ¸ë™`;n=P.value.some(e=>e.id===t.id)?`í™”ë©´ ê³µìœ  ì˜¤ë””ì˜¤`:`ì›¹ìº  ë§ˆì´í¬`,Z.value.has(t.id)||Z.value.set(t.id,1);let r=Z.value.get(t.id);e.push({track:t,label:n,volume:r})}),e});function xt(e){return e.slice(-6)}function St(){q&&clearInterval(q);let e=``,t=()=>{let t=``;if(X.length>1)do t=X[Math.floor(Math.random()*X.length)];while(t===e);else X.length===1&&(t=X[0]);ct.value=t,e=t};t(),q=setInterval(t,2e3)}function Q(e){q&&=(clearInterval(q),null),m.value=e,oe(()=>{if(e===`home`){let e=document.getElementById(`username-input`);e&&e.focus()}else if(e===`video`){let e=document.getElementById(`message-input`);e&&e.focus(),window.innerWidth>768?C.value=!1:C.value=!0}})}function $(e,t,n=null){ut.value=e,dt.value=t,ft.value=!!n,S.value=n,lt.value=!0}function Ct(){lt.value=!1,S.value=null}function wt(){S.value&&S.value(),Ct()}function Tt(){F.value={includeAudio:!1,keepCamera:!1},mt.value=!0}function Et(){mt.value=!1}function Dt(){Et(),Rt(F.value)}function Ot(){L.value||=new(window.AudioContext||window.webkitAudioContext),k.value&&k.value.getAudioTracks().forEach(e=>{I.has(e.id)||At(e)}),ht.value=!0}function kt(){ht.value=!1}function At(e){L.value||=new(window.AudioContext||window.webkitAudioContext);try{let t=L.value.createMediaStreamSource(new MediaStream([e])),n=L.value.createGain();n.gain.value=1,t.connect(n),n.connect(L.value.destination),I.set(e.id,n)}catch(e){console.error(`ì˜¤ë””ì˜¤ íŠ¸ë™ GainNode ì„¤ì • ì‹¤íŒ¨:`,e)}}function jt(e,t){Z.value.set(e.id,t);let n=I.get(e.id);if(n)n.gain.value=t;else{At(e);let n=I.get(e.id);n&&(n.gain.value=t)}}function Mt(e){return new Date(e).toLocaleTimeString(`ko-KR`,{hour:`2-digit`,minute:`2-digit`})}function Nt(e,t=null){for(let[n,r]of z)if(n!==t)try{r.send(e)}catch(e){console.error(`Peer ${n}ë¡œ ì „ì†¡ ì‹¤íŒ¨:`,e)}}function Pt(){let e=Array.from(B.entries()).map(([e,{name:t,shortId:n}])=>({id:e,name:t,shortId:n})),t={type:`participantUpdate`,payload:{hostName:v.value,hostShortId:y.value,guests:e}};Nt(t)}function Ft(){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){let e=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;if(!e)return{supported:!1,error:`ì´ ë¸Œë¼ìš°ì €ëŠ” ë¯¸ë””ì–´ ë””ë°”ì´ìŠ¤ APIë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.`};navigator.mediaDevices={getUserMedia:t=>new Promise((n,r)=>{e.call(navigator,t,n,r)})}}return{supported:!0}}async function It(){try{let e=Ft();if(!e.supported)return $(`ë¯¸ë””ì–´ ì ‘ê·¼ ì‹¤íŒ¨`,e.error||`ì´ ë¸Œë¼ìš°ì €ëŠ” ì¹´ë©”ë¼/ë§ˆì´í¬ ì ‘ê·¼ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.`),null;let t=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:1920},height:{ideal:1080},frameRate:{ideal:30},facingMode:`user`},audio:{sampleRate:48e3,echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}});return k.value=t,D.value&&(D.value.srcObject=t),t}catch(e){return console.error(`ë¯¸ë””ì–´ ìŠ¤íŠ¸ë¦¼ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:`,e),$(`ë¯¸ë””ì–´ ì ‘ê·¼ ì‹¤íŒ¨`,`ì¹´ë©”ë¼/ë§ˆì´í¬ ì ‘ê·¼ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ${e.message}`),null}}function Lt(){k.value&&=(k.value.getTracks().forEach(e=>e.stop()),null),A.value&&=(A.value.getTracks().forEach(e=>e.stop()),null),M.value&&=(M.value.getTracks().forEach(e=>e.stop()),null),D.value&&(D.value.srcObject=null),O.value&&(O.value.srcObject=null),j.value=!1}async function Rt(e={includeAudio:!1,keepCamera:!1}){try{if(!navigator.mediaDevices||!navigator.mediaDevices.getDisplayMedia){$(`í™”ë©´ ê³µìœ  ì‹¤íŒ¨`,`ì´ ë¸Œë¼ìš°ì €ëŠ” í™”ë©´ ê³µìœ ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ìµœì‹  ë¸Œë¼ìš°ì €ë¥¼ ì‚¬ìš©í•´ì£¼ì„¸ìš”.`);return}let t=await navigator.mediaDevices.getDisplayMedia({video:{cursor:`always`},audio:e.includeAudio||!1});if(M.value=t,j.value=!0,P.value=[],e.includeAudio&&t.getAudioTracks().length>0&&t.getAudioTracks().forEach(e=>{P.value.push(e)}),!k.value)k.value=t,D.value&&(D.value.srcObject=t);else{let n=t.getVideoTracks()[0],r=k.value.getVideoTracks()[0];e.keepCamera&&r?(N.value=r,k.value.removeTrack(r),k.value.addTrack(n)):(r&&(k.value.removeTrack(r),r.stop()),k.value.addTrack(n)),e.includeAudio&&P.value.length>0&&P.value.forEach(e=>{k.value.getAudioTracks().find(t=>t.id===e.id)||k.value.addTrack(e)}),D.value&&(D.value.srcObject=k.value)}if(k.value){let t=k.value.getVideoTracks()[0];for(let[n,r]of V)try{let n=r?.peerConnection||r?._pc;if(n){let r=n.getSenders().find(e=>e.track&&e.track.kind===`video`);r&&await r.replaceTrack(t),e.includeAudio&&P.value.length>0&&P.value.forEach(e=>{n.getSenders().find(t=>t.track&&t.track.id===e.id)||n.addTrack(e,k.value)})}}catch(e){console.error(`í”¼ì–´ ${n}ì—ê²Œ íŠ¸ë™ êµì²´ ì‹¤íŒ¨:`,e)}}t.getVideoTracks()[0].onended=()=>{zt()}}catch(e){console.error(`í™”ë©´ ê³µìœ  ì‹¤íŒ¨:`,e),e.name===`NotAllowedError`||e.name===`PermissionDeniedError`?$(`í™”ë©´ ê³µìœ  ê¶Œí•œ ê±°ë¶€`,`í™”ë©´ ê³µìœ  ê¶Œí•œì´ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì € ì„¤ì •ì—ì„œ ê¶Œí•œì„ í—ˆìš©í•´ì£¼ì„¸ìš”.`):e.name===`NotFoundError`?$(`í™”ë©´ ê³µìœ  ì‹¤íŒ¨`,`ê³µìœ í•  ìˆ˜ ìˆëŠ” í™”ë©´ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`):$(`í™”ë©´ ê³µìœ  ì‹¤íŒ¨`,`í™”ë©´ ê³µìœ  ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${e.message}`),j.value=!1,P.value=[]}}async function zt(){if(j.value)try{if(!k.value){j.value=!1;return}let e=k.value.getVideoTracks().find(e=>M.value&&M.value.getVideoTracks().some(t=>t.id===e.id));e&&(k.value.removeTrack(e),e.stop());let t=[...P.value];if(t.length>0&&t.forEach(e=>{let t=k.value.getAudioTracks().find(t=>t.id===e.id);t&&k.value.removeTrack(t),e.stop()}),M.value&&=(M.value.getTracks().forEach(e=>{e.readyState!==`ended`&&e.stop()}),null),N.value&&N.value.readyState!==`ended`){let e=k.value.getVideoTracks()[0];e?e.id!==N.value.id&&(k.value.removeTrack(e),e.stop(),k.value.addTrack(N.value)):k.value.addTrack(N.value),N.value=null}else await Bt();for(let[e,n]of V)try{let e=n?.peerConnection||n?._pc;if(e){t.length>0&&e.getSenders().forEach(n=>{n.track&&t.some(e=>e.id===n.track.id)&&e.removeTrack(n)});let n=k.value.getVideoTracks()[0];if(n){let t=e.getSenders().find(e=>e.track&&e.track.kind===`video`);t&&await t.replaceTrack(n)}}}catch(t){console.error(`í”¼ì–´ ${e}ì—ê²Œ íŠ¸ë™ ì œê±° ì‹¤íŒ¨:`,t)}D.value&&(D.value.srcObject=k.value),P.value=[],j.value=!1}catch(e){console.error(`í™”ë©´ ê³µìœ  ì¤‘ì§€ ì‹¤íŒ¨:`,e),$(`ì˜¤ë¥˜`,`í™”ë©´ ê³µìœ ë¥¼ ì¤‘ì§€í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.`),j.value=!1}}async function Bt(){try{let e=Ft();if(!e.supported){$(`ì¹´ë©”ë¼ ì ‘ê·¼ ì‹¤íŒ¨`,e.error||`ì´ ë¸Œë¼ìš°ì €ëŠ” ì¹´ë©”ë¼ ì ‘ê·¼ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.`);return}let t=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:1920},height:{ideal:1080},frameRate:{ideal:30},facingMode:`user`},audio:{sampleRate:48e3,echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}});if(k.value){let e=t.getVideoTracks()[0],n=k.value.getVideoTracks().find(e=>e.kind===`video`);n&&(k.value.removeTrack(n),n.stop()),k.value.addTrack(e)}else k.value=t;if(D.value&&(D.value.srcObject=k.value),t.getAudioTracks().length>0&&k.value){let e=t.getAudioTracks()[0],n=k.value.getAudioTracks()[0];n&&(k.value.removeTrack(n),n.stop()),k.value.addTrack(e)}for(let[e,t]of V)try{let e=t?.peerConnection||t?._pc;if(e&&k.value){let t=k.value.getVideoTracks()[0];if(t){let n=e.getSenders().find(e=>e.track&&e.track.kind===`video`);n&&await n.replaceTrack(t)}let n=k.value.getAudioTracks()[0];if(n){let t=e.getSenders().find(e=>e.track&&e.track.kind===`audio`);t?await t.replaceTrack(n):e.addTrack(n,k.value)}}}catch(t){console.error(`í”¼ì–´ ${e}ì—ê²Œ íŠ¸ë™ êµì²´ ì‹¤íŒ¨:`,t)}}catch(e){console.error(`ì¹´ë©”ë¼ ì „í™˜ ì‹¤íŒ¨:`,e),$(`ì¹´ë©”ë¼ ì ‘ê·¼ ì‹¤íŒ¨`,`ì¹´ë©”ë¼ì— ì ‘ê·¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤: ${e.message}`)}}function Vt(e,t){if(!(!e||!e.type))if(g.value)switch(e.type){case`name`:B.set(t,{name:e.payload.name,shortId:e.payload.shortId}),z.get(t).send({type:`name`,payload:{name:v.value,shortId:y.value},id:_.value}),z.get(t).send({type:`roomInfo`,payload:{roomUrl:H.value}}),Pt();break;case`chat`:let n=B.get(t)||{name:`ì•Œ ìˆ˜ ì—†ëŠ” ì‚¬ìš©ì`,shortId:`??????`},r={text:e.payload,displayName:n.name,shortId:n.shortId,timestamp:e.timestamp,type:`chat`,senderId:t};K.value.push(r),Nt({type:`chat`,payload:e.payload,timestamp:e.timestamp,sender:{id:t,name:n.name,shortId:n.shortId}},t);break}else switch(e.type){case`name`:W.value=e.payload.name,G.value=e.payload.shortId;break;case`roomInfo`:H.value=e.payload.roomUrl,E.value&&window.QRCode&&(Y&&=(Y.clear(),null),E.value.innerHTML=``,Y=new window.QRCode(E.value,{text:e.payload.roomUrl,width:160,height:160}));break;case`participantUpdate`:W.value=e.payload.hostName,G.value=e.payload.hostShortId;break;case`chat`:K.value.push({text:e.payload,displayName:e.sender.name,shortId:e.sender.shortId,timestamp:e.timestamp,type:`chat`,senderId:e.sender.id});break}}function Ht(e){e.on(`open`,()=>{if(console.log(`ë°ì´í„° ì±„ë„ ì—´ë¦¼: ${e.peer}`),g.value){if(k.value){let t=R.call(e.peer,k.value);t&&(V.set(e.peer,t),Ut(t,e.peer))}Q(`video`)}else{U=e;let t={type:`name`,payload:{name:v.value,shortId:y.value},id:_.value};if(U.send(t),k.value){let e=R.call(b.value,k.value);e&&(V.set(b.value,e),Ut(e,b.value))}Q(`video`)}}),e.on(`data`,t=>{Vt(t,e.peer)}),e.on(`close`,()=>{if(console.log(`ì—°ê²° ì¢…ë£Œ: ${e.peer}`),g.value){let t=e.peer;z.delete(t),B.delete(t);let n=V.get(t);n&&(n.close(),V.delete(t)),Pt()}else{e.kicked||$(`í˜¸ìŠ¤íŠ¸ ì—°ê²° ëŠê¹€`,`í˜¸ìŠ¤íŠ¸ì™€ì˜ ì—°ê²°ì´ ëŠì–´ì¡ŒìŠµë‹ˆë‹¤.`),U=null;let t=V.get(b.value);t&&(t.close(),V.delete(b.value))}}),e.on(`error`,t=>{console.error(`ì—°ê²° ì—ëŸ¬:`,t),g.value?$(`ê²ŒìŠ¤íŠ¸ ì—°ê²° ì˜¤ë¥˜`,`${e.peer}ì™€ ì—°ê²° ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ${t.message}`):$(`ì—°ê²° ì˜¤ë¥˜`,`ì˜¤ë¥˜ ë°œìƒ: ${t.message}`)})}function Ut(e,t){e.on(`stream`,e=>{console.log(`ì›ê²© ìŠ¤íŠ¸ë¦¼ ìˆ˜ì‹ :`,t),A.value=e,O.value&&(O.value.srcObject=e)}),e.on(`close`,()=>{console.log(`ë¯¸ë””ì–´ í˜¸ì¶œ ì¢…ë£Œ:`,t),A.value&&=(A.value.getTracks().forEach(e=>e.stop()),null),O.value&&(O.value.srcObject=null),V.delete(t)}),e.on(`error`,e=>{console.error(`ë¯¸ë””ì–´ í˜¸ì¶œ ì—ëŸ¬:`,e),$(`ë¯¸ë””ì–´ ì—°ê²° ì˜¤ë¥˜`,`ë¯¸ë””ì–´ ìŠ¤íŠ¸ë¦¼ êµí™˜ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ${e.message}`)})}function Wt(){Q(`waiting`),St(),x.value=`Peer ì„œë²„ì— ì—°ê²° ì¤‘...`,R=new window.Peer(null,{debug:2,host:`peerjs.jaehyung101.synology.me`,secure:!0,proxied:!0}),R.on(`open`,async e=>{_.value=e,y.value||(y.value=xt(_.value),sessionStorage.setItem(`webrtc-shortId`,y.value)),console.log(`ë‚´ Peer ID (í˜¸ìŠ¤íŠ¸): ${_.value} (#${y.value})`);let t=`${window.location.origin}${window.location.pathname}#${_.value}`;if(H.value=t,x.value=`ë¯¸ë””ì–´ ìŠ¤íŠ¸ë¦¼ ì¤€ë¹„ ì¤‘...`,!await It()){Q(`home`);return}x.value=`ìƒëŒ€ë°©ì˜ ì—°ê²°ì„ ê¸°ë‹¤ë¦¬ëŠ” ì¤‘...`,T.value&&window.QRCode&&(J&&=(J.clear(),null),T.value.innerHTML=``,J=new window.QRCode(T.value,{text:t,width:256,height:256})),E.value&&window.QRCode&&(Y&&=(Y.clear(),null),E.value.innerHTML=``,Y=new window.QRCode(E.value,{text:t,width:160,height:160}))}),R.on(`connection`,e=>{console.log(`ìƒˆ ì—°ê²° ì‹œë„: ${e.peer}`),z.set(e.peer,e),Ht(e)}),R.on(`call`,e=>{console.log(`ë¯¸ë””ì–´ í˜¸ì¶œ ìˆ˜ì‹ :`,e.peer),k.value&&(e.answer(k.value),V.set(e.peer,e),Ut(e,e.peer))}),R.on(`error`,e=>{console.error(`Peer ì—ëŸ¬:`,e),$(`ì—°ê²° ì‹¤íŒ¨`,`Peer ì„œë²„ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ${e.message}`),Lt(),Q(`home`)})}function Gt(e){Q(`waiting`),St(),x.value=`í˜¸ìŠ¤íŠ¸ì— ì—°ê²° ì¤‘...`,R=new window.Peer(null,{debug:3,host:`peerjs.jaehyung101.synology.me`,secure:!0,proxied:!0}),R.on(`open`,async t=>{if(_.value=t,y.value||(y.value=xt(_.value),sessionStorage.setItem(`webrtc-shortId`,y.value)),console.log(`ë‚´ Peer ID (ê²ŒìŠ¤íŠ¸): ${t} (#${y.value})`),x.value=`ë¯¸ë””ì–´ ìŠ¤íŠ¸ë¦¼ ì¤€ë¹„ ì¤‘...`,!await It()){Q(`home`);return}x.value=`í˜¸ìŠ¤íŠ¸ì— ì—°ê²° ì¤‘...`;let n=R.connect(e,{reliable:!0});if(!n){console.error(`í˜¸ìŠ¤íŠ¸ì— ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`),$(`ì—°ê²° ì‹¤íŒ¨`,`í˜¸ìŠ¤íŠ¸ì— ì—°ê²°ì„ ì‹œë„í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`),Lt(),Q(`home`);return}Ht(n)}),R.on(`call`,e=>{console.log(`ë¯¸ë””ì–´ í˜¸ì¶œ ìˆ˜ì‹ :`,e.peer),k.value&&(e.answer(k.value),V.set(e.peer,e),Ut(e,e.peer))}),R.on(`error`,e=>{console.error(`Peer ì—ëŸ¬:`,e);let t=`Peer ì˜¤ë¥˜: ${e.message}`;e.type===`peer-unavailable`&&(t=`í•´ë‹¹ ë£¸ IDë¥¼ ì°¾ì„ ìˆ˜ ì—†ê±°ë‚˜ í˜¸ìŠ¤íŠ¸ê°€ ì˜¤í”„ë¼ì¸ì…ë‹ˆë‹¤.`),$(`ì—°ê²° ì‹¤íŒ¨`,t),Lt(),window.location.hash=``,Q(`home`)})}function Kt(){let e=st.value.trim();if(!e){$(`ì´ë¦„ í•„ìš”`,`í™”ìƒí†µí™”ì—ì„œ ì‚¬ìš©í•  ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”.`);return}v.value=e,g.value?Wt():Gt(b.value)}function qt(){let e=h.value.trim();if(!e)return;let t=new Date().toISOString(),n={text:e,displayName:v.value,shortId:y.value,timestamp:t,type:`chat`,senderId:_.value};K.value.push(n),h.value=``;let r={type:`chat`,payload:e,timestamp:t,sender:{id:_.value,name:v.value,shortId:y.value}};g.value?Nt(r):U&&U.open&&U.send(r)}function Jt(){C.value=!C.value}function Yt(e){return e.preventDefault(),e.returnValue=`ì •ë§ ë‚˜ê°€ì‹œê² ìŠµë‹ˆê¹Œ?`,`ì •ë§ ë‚˜ê°€ì‹œê² ìŠµë‹ˆê¹Œ?`}function Xt(e){return new Promise((t,n)=>{if(document.querySelector(`script[src="${e}"]`)){t();return}let r=document.createElement(`script`);r.src=e,r.onload=t,r.onerror=n,document.head.appendChild(r)})}return o(K,()=>{oe(()=>{w.value&&(w.value.scrollTop=w.value.scrollHeight)})}),te(async()=>{try{await Promise.all([Xt(`https://cdn.tailwindcss.com`),Xt(`https://unpkg.com/peerjs@1.5.4/dist/peerjs.min.js`),Xt(`https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js`)])}catch(e){console.error(`ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ ì‹¤íŒ¨:`,e),$(`ë¡œë“œ ì˜¤ë¥˜`,`í•„ìˆ˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë¡œë“œí•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.`)}y.value=sessionStorage.getItem(`webrtc-shortId`),window.location.hash?(b.value=window.location.hash.substring(1),g.value=!1):g.value=!0,Q(`home`)}),ae(()=>{q&&clearInterval(q),Lt(),R&&R.destroy(),J&&=(J.clear(),null),Y&&=(Y.clear(),null)}),(i,o)=>(a(),l(`div`,{class:`webrtc-video-app`,onBeforeunload:Yt},[c(`div`,ce,[c(`div`,{id:`home-view`,class:e([`home-view`,{hidden:m.value!==`home`}])},[o[5]||=c(`h1`,null,`WebRTC í™”ìƒí†µí™”`,-1),o[6]||=c(`p`,null,`ì„œë²„ ì—†ì´ QR ì½”ë“œë¡œ ì—°ê²°í•˜ëŠ” P2P í™”ìƒí†µí™”`,-1),n(c(`input`,{id:`username-input`,"onUpdate:modelValue":o[0]||=e=>st.value=e,type:`text`,placeholder:`ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”...`,onKeydown:ne(Kt,[`enter`]),autocomplete:`off`,autocapitalize:`off`},null,544),[[re,st.value]]),c(`button`,{id:`start-btn`,onClick:Kt},r(g.value?`ìƒˆ í™”ìƒí†µí™” ë§Œë“¤ê¸°`:`í™”ìƒí†µí™” ì°¸ì—¬í•˜ê¸°`),1)],2),c(`div`,{id:`waiting-view`,class:e([`waiting-view`,{hidden:m.value!==`waiting`}])},[g.value?(a(),l(`h2`,le,`í™”ìƒí†µí™”ë°© ìƒì„±ë¨`)):f(``,!0),g.value?(a(),l(`p`,ue,`ì•„ë˜ QR ì½”ë“œë¥¼ ìƒëŒ€ë°©ì´ ìŠ¤ìº”í•˜ê²Œ í•˜ì„¸ìš”.`)):f(``,!0),g.value?(a(),l(`div`,de,[c(`div`,{id:`qrcode`,ref_key:`qrcodeContainer`,ref:T},null,512)])):f(``,!0),g.value&&u(H)?(a(),l(`a`,{key:3,href:u(H),target:`_blank`,class:`room-link`},r(u(H)),9,fe)):f(``,!0),g.value&&_.value?(a(),l(`div`,pe,` ë‚´ ë£¸ ID: `+r(_.value),1)):f(``,!0),c(`div`,me,[o[7]||=c(`svg`,{class:`spinner`,xmlns:`http://www.w3.org/2000/svg`,fill:`none`,viewBox:`0 0 24 24`},[c(`circle`,{class:`opacity-25`,cx:`12`,cy:`12`,r:`10`,stroke:`currentColor`,"stroke-width":`4`}),c(`path`,{class:`opacity-75`,fill:`currentColor`,d:`M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z`})],-1),c(`span`,he,r(x.value),1)]),ct.value?(a(),l(`p`,ge,r(ct.value),1)):f(``,!0)],2),c(`div`,{id:`video-view`,class:e([`video-view`,{hidden:m.value!==`video`}])},[c(`div`,_e,[c(`header`,ve,[c(`span`,ye,r(vt.value),1),c(`div`,be,[c(`button`,{id:`audio-volume-btn`,class:`audio-volume-btn`,onClick:Ot,title:`ì˜¤ë””ì˜¤ ë³¼ë¥¨ ì¡°ì ˆ`},[...o[8]||=[c(`svg`,{class:`w-6 h-6`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`},[c(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z`})],-1)]]),c(`button`,{id:`screen-share-btn`,class:`screen-share-btn`,onClick:o[1]||=e=>j.value?zt():Tt(),title:j.value?`ì¹´ë©”ë¼ë¡œ ì „í™˜`:`í™”ë©´ ê³µìœ `},[j.value?(a(),l(`svg`,Ce,[...o[10]||=[c(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z`},null,-1)]])):(a(),l(`svg`,Se,[...o[9]||=[c(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z`},null,-1)]]))],8,xe),c(`button`,{id:`options-btn`,class:`options-btn md:hidden`,onClick:Jt},[...o[11]||=[c(`svg`,{class:`w-6 h-6`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`},[c(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z`})],-1)]])])]),c(`div`,we,[c(`div`,Te,[c(`video`,{ref_key:`remoteVideo`,ref:O,autoplay:``,playsinline:``,class:e([`remote-video`,{hidden:!A.value}])},null,2),A.value?f(``,!0):(a(),l(`div`,Ee,[...o[12]||=[c(`svg`,{class:`w-24 h-24 text-gray-500`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`},[c(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z`})],-1),c(`p`,{class:`text-gray-400 mt-4`},`ìƒëŒ€ë°© ì—°ê²° ëŒ€ê¸° ì¤‘...`,-1)]]))]),c(`div`,De,[c(`video`,{ref_key:`localVideo`,ref:D,autoplay:``,playsinline:``,muted:``,class:e([`local-video`,{hidden:!k.value}])},null,2),j.value?(a(),l(`div`,Oe,[o[13]||=c(`svg`,{class:`w-4 h-4`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`},[c(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z`})],-1),o[14]||=c(`span`,null,`í™”ë©´ ê³µìœ  ì¤‘`,-1),P.value.length>0?(a(),l(`span`,ke,`ğŸ”Š`)):f(``,!0),N.value?(a(),l(`span`,Ae,`ğŸ“¹`)):f(``,!0)])):f(``,!0),k.value?f(``,!0):(a(),l(`div`,je,[...o[15]||=[c(`svg`,{class:`w-8 h-8 text-gray-500`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`},[c(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z`})],-1)]]))])]),c(`form`,{onSubmit:d(qt,[`prevent`]),class:`chat-form`},[n(c(`input`,{id:`message-input`,"onUpdate:modelValue":o[2]||=e=>h.value=e,type:`text`,placeholder:`ë©”ì‹œì§€ ì…ë ¥...`,autocomplete:`off`},null,512),[[re,h.value]]),o[16]||=c(`button`,{type:`submit`},[c(`svg`,{class:`w-6 h-6`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`},[c(`path`,{"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-width":`2`,d:`M12 19l9 2-9-18-9 18 9-2zm0 0v-8`})])],-1)],32)]),c(`div`,{id:`sidebar`,ref_key:`sidebar`,ref:pt,class:e([`sidebar`,{hidden:C.value}])},[c(`div`,Me,[o[17]||=c(`h3`,null,`ì±„íŒ…`,-1),c(`div`,{id:`messages`,ref_key:`messagesContainer`,ref:w,class:`messages`},[(a(!0),l(p,null,t(_t.value,(t,n)=>(a(),l(`div`,{key:n,class:e([`message-item`,{"message-right":t.senderId===_.value,"message-left":t.senderId!==_.value}])},[c(`div`,{class:e([`message-bubble`,{"bg-blue-600":t.senderId===_.value,"bg-gray-700":t.senderId!==_.value}])},[t.senderId===_.value?f(``,!0):(a(),l(`div`,Ne,[ee(r(t.displayName)+` `,1),c(`span`,Pe,`#`+r(t.shortId),1)])),c(`div`,Fe,r(t.text),1),c(`div`,Ie,r(Mt(t.timestamp)),1)],2)],2))),128))],512)]),c(`div`,Le,[o[18]||=c(`h3`,null,`ì°¸ì—¬ QR ì½”ë“œ`,-1),c(`div`,Re,[c(`div`,{id:`qrcode-chat`,ref_key:`qrcodeChatContainer`,ref:E},null,512)]),yt.value?(a(),l(`a`,{key:0,href:yt.value,target:`_blank`,class:`sidebar-room-link`},r(yt.value),9,ze)):f(``,!0)]),c(`div`,Be,[o[19]||=c(`h3`,null,`ì°¸ì—¬ì`,-1),c(`ul`,Ve,[c(`li`,He,[ee(` ğŸ‘‘ `+r(u(W)||v.value)+` `,1),c(`span`,Ue,`#`+r(u(G)||y.value),1),(u(G)||y.value)===y.value?(a(),l(`span`,We,`(ë‚˜)`)):(a(),l(`span`,Ge,`(ë°©ì¥)`))]),(a(!0),l(p,null,t(gt.value,t=>(a(),l(`li`,{key:t.id,class:e([`guest-item`,{"is-me":t.shortId===y.value}])},[c(`span`,null,[ee(`ğŸ‘¤ `+r(t.name)+` `,1),c(`span`,Ke,`#`+r(t.shortId),1)]),t.shortId===y.value?(a(),l(`span`,qe,`(ë‚˜)`)):f(``,!0)],2))),128))])])],2)],2),c(`div`,{id:`modal`,class:e([`modal-overlay`,{hidden:!lt.value}]),onClick:d(Ct,[`self`])},[c(`div`,Je,[c(`h3`,null,r(ut.value),1),c(`p`,null,r(dt.value),1),c(`div`,Ye,[ft.value?(a(),l(p,{key:1},[c(`button`,{onClick:wt,class:`btn-modal-confirm`},`í™•ì¸`),c(`button`,{onClick:Ct,class:`btn-modal-cancel`},`ì·¨ì†Œ`)],64)):(a(),l(`button`,{key:0,onClick:Ct,class:`btn-modal-ok`},`í™•ì¸`))])])],2),c(`div`,{id:`screen-share-options-modal`,class:e([`modal-overlay`,{hidden:!mt.value}]),onClick:d(Et,[`self`])},[c(`div`,Xe,[o[22]||=c(`h3`,null,`í™”ë©´ ê³µìœ  ì˜µì…˜`,-1),c(`div`,Ze,[c(`label`,Qe,[n(c(`input`,{type:`checkbox`,"onUpdate:modelValue":o[3]||=e=>F.value.includeAudio=e},null,512),[[ie,F.value.includeAudio]]),o[20]||=c(`span`,null,`ì˜¤ë””ì˜¤ë„ ê³µìœ í•˜ê¸°`,-1)]),c(`label`,$e,[n(c(`input`,{type:`checkbox`,"onUpdate:modelValue":o[4]||=e=>F.value.keepCamera=e},null,512),[[ie,F.value.keepCamera]]),o[21]||=c(`span`,null,`ì›¹ìº ë„ í•¨ê»˜ í‘œì‹œí•˜ê¸°`,-1)])]),c(`div`,{class:`modal-actions`},[c(`button`,{onClick:Dt,class:`btn-modal-confirm`},`ì‹œì‘`),c(`button`,{onClick:Et,class:`btn-modal-cancel`},`ì·¨ì†Œ`)])])],2),c(`div`,{id:`audio-volume-modal`,class:e([`modal-overlay`,{hidden:!ht.value}]),onClick:d(kt,[`self`])},[c(`div`,et,[o[24]||=c(`h3`,null,`ì˜¤ë””ì˜¤ ë³¼ë¥¨ ì¡°ì ˆ`,-1),bt.value.length>0?(a(),l(`div`,tt,[(a(!0),l(p,null,t(bt.value,e=>(a(),l(`div`,{key:e.track.id,class:`audio-track-item`},[c(`div`,nt,[c(`span`,rt,r(e.label),1),c(`span`,it,r(Math.round(e.volume*100))+`%`,1)]),c(`input`,{type:`range`,min:`0`,max:`1`,step:`0.01`,value:e.volume,onInput:t=>jt(e.track,parseFloat(t.target.value)),class:`volume-slider`},null,40,at)]))),128))])):(a(),l(`div`,ot,[...o[23]||=[c(`p`,null,`í˜„ì¬ í™œì„±í™”ëœ ì˜¤ë””ì˜¤ íŠ¸ë™ì´ ì—†ìŠµë‹ˆë‹¤.`,-1)]])),c(`div`,{class:`modal-actions`},[c(`button`,{onClick:kt,class:`btn-modal-ok`},`ë‹«ê¸°`)])])],2)])],32))}},[[`__scopeId`,`data-v-ccbcf263`]]);export{m as default};