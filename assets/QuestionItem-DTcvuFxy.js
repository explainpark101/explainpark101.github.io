import{A as e,D as t,M as n,O as r,S as i,T as a,d as o,f as s,h as c,o as l,s as u}from"./index-BsTOteZI.js";import{t as d}from"./_plugin-vue_export-helper-9n1O4nl6.js";var f={class:`question`},p=[`for`],m=[`id`],h={__name:`QuestionItem`,props:{question:{type:Object,required:!0}},emits:[`focus`,`blur`,`input`,`grade`,`keydown`,`enter-correct`],setup(d,{expose:h,emit:g}){let _=d,v=g,y=r(_.question.inputValue||``),b=r(!0),x=r(!1),S=null,C=e=>(e=e.replace(/\s+/g,``),e=e.replace(/[-,]/g,``),e.toLowerCase()),w=(e,t)=>{if(e.length===0)return t.length;if(t.length===0)return e.length;let n=[];for(let e=0;e<=t.length;e++)n[e]=[e];for(let t=0;t<=e.length;t++)n[0][t]=t;for(let r=1;r<=t.length;r++)for(let i=1;i<=e.length;i++)t.charAt(r-1)===e.charAt(i-1)?n[r][i]=n[r-1][i-1]:n[r][i]=Math.min(n[r-1][i-1]+1,n[r][i-1]+1,n[r-1][i]+1);return n[t.length][e.length]},T=(e,t)=>{let n=C(e),r=C(t);return n===r||Math.abs(n.length-r.length)>1?!1:w(n,r)===1},E=()=>{let e=y.value.trim();if(!e)return{result:null,text:``,class:`result`,isIncorrect:!1};let t=_.question.answer.split(/[,]| or /).map(e=>e.trim()),n=C(e);if(t.some(e=>C(e)===n))return{result:!0,text:`정답`,class:`result correct`,isIncorrect:!1};if(t.find(t=>T(e,t))){let e=t.filter(e=>C(e)!==n),r=`정답(오타를 정정해주세요)`;return e.length>0&&(r+=` (다른 정답: ${e.join(`, `)})`),{result:!1,text:r,class:`result incorrect`,isIncorrect:!0}}return{result:!1,text:`오답 (정답: ${_.question.answer})`,class:`result incorrect`,isIncorrect:!0}},D=r({result:null,text:``,class:`result`,isIncorrect:!1}),O=o(()=>x.value?D.value.text:``),k=o(()=>x.value?D.value.class:`result`),A=()=>y.value.trim()?(D.value=E(),x.value=!0,D.value.result):null,j=(e=!1)=>{!e&&D.value.isIncorrect||(y.value=``,x.value=!1,D.value={result:null,text:``,class:`result`,isIncorrect:!1},S&&=(clearTimeout(S),null))},M=()=>({abbr:_.question.abbr,value:y.value,isGraded:x.value,isIncorrect:D.value.isIncorrect,isVisible:b.value}),N=e=>{e&&(y.value=e.value||``,b.value=e.isVisible!==!1,e.value&&e.value.trim()?(D.value=E(),x.value=e.isGraded!==!1):(x.value=!1,D.value={result:null,text:``,class:`result`,isIncorrect:!1}))},P=e=>{_.question.index=e},F=e=>{b.value=e},I=()=>{v(`focus`,_.question)},L=()=>{y.value.trim()?A():(x.value=!1,D.value={result:null,text:``,class:`result`,isIncorrect:!1}),v(`blur`,_.question),v(`grade`,D.value.result)},R=()=>{x.value=!1,D.value={result:null,text:``,class:`result`,isIncorrect:!1},S&&clearTimeout(S),S=setTimeout(()=>{y.value.trim()&&(A(),v(`grade`,D.value.result)),S=null},800),v(`input`,_.question)},z=e=>{if(e.key===`Enter`&&(e.preventDefault(),S&&=(clearTimeout(S),null),y.value.trim())){let e=A();v(`grade`,e),e===!0&&v(`enter-correct`,_.question)}v(`keydown`,_.question,e)};return h({grade:A,reset:j,saveState:M,loadState:N,updateIndex:P,setVisible:F,inputValue:y,isVisible:b}),a(y,e=>{_.question.inputValue=e}),(r,a)=>t((i(),c(`div`,f,[s(`label`,{for:`ans-${d.question.abbr}`},n(d.question.index)+`. `+n(d.question.abbr),9,p),t(s(`input`,{id:`ans-${d.question.abbr}`,type:`text`,"onUpdate:modelValue":a[0]||=e=>y.value=e,autocomplete:`off`,onFocus:I,onBlur:L,onInput:R,onKeydown:z},null,40,m),[[l,y.value]]),s(`div`,{class:e(k.value)},n(O.value),3)],512)),[[u,b.value]])}},g=d(h,[[`__scopeId`,`data-v-ef56a1e3`]]);export{g as t};